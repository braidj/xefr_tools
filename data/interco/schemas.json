[{"id":"c9880ce5-5b18-4fdf-976b-0e4d722bbb20","name":"Adjustments Interco","description":"Post InterCo Adjustments for GBP reporting","attributes":[{"id":"cd6b7dbc-7a85-4a31-b7c0-787175b891cb","name":"Year","type":"STRING"},{"id":"c7c76f1a-1ce1-4e16-9e06-922efe584537","name":"Month","type":"DROP_DOWN","additionalOptions":{"items":["01-Jan","02-Feb","03-Mar","04-Apr","05-May","06-Jun","07-Jul","08-Aug","09-Sep","10-Oct","11-Nov","12-Dec"]}},{"id":"9de160ef-db9b-4782-b9ff-80ae419a7b3e","name":"GBP Amount","type":"NUMBER"}],"autoGenerateId":true,"indexes":[{"attributeIds":["cd6b7dbc-7a85-4a31-b7c0-787175b891cb","c7c76f1a-1ce1-4e16-9e06-922efe584537"],"concatenatedFieldName":"InterCoLookup"}],"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"a9160d18-330d-45ef-81d7-8599a75b2fe1","name":"Adjustments UK NFI","description":"UK NFI Adjustments only","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"a3948ea7-82db-4d7a-9133-cf898d696f48","name":"Candidate","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"74633e84-deba-4720-8181-c07629a1c665","attributeId":"0b53493f-debc-46fd-9acf-b1db2e233ff3","allowOther":true}},{"id":"b564375f-876a-49aa-b20e-19f5ea0aefbf","name":"CompanyName","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"74633e84-deba-4720-8181-c07629a1c665","attributeId":"ff566028-d412-4244-90e7-e0afa1b9166a","allowOther":true}},{"id":"17859b1c-fa44-431b-a741-b9ee16725c0f","name":"Placement","type":"STRING"},{"id":"682d0573-ad88-4d46-977a-430c8484033c","name":"InvoiceDate","type":"DATE"},{"id":"7ba13df8-31ee-4627-82aa-2efbdbde710b","name":"Currency","type":"DROP_DOWN","additionalOptions":{"schemaId":"af272168-14fc-4575-b97f-19e28da4d20a","attributeId":"00aaa5c2-00bc-49a1-a349-0bc849a69c12","items":["£","$"]}},{"id":"e3e4f6cc-7944-46be-9fd9-760e4e268ac7","name":"LinePrice","type":"NUMBER"},{"id":"56d94c01-d68f-4ed8-83fe-9f21788445ea","name":"ChargeCode","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"3029f855-9e82-43e0-ae04-ff3da948c936","attributeId":"0a6bf19b-147c-428b-9607-c7029edaebf9"}},{"id":"266d906e-75fa-4b1b-87b8-e286147c11b8","name":"Source","type":"STRING","defaultValueFunction":"","calculatedValueFunction":"\"XEFR\"","tooltip":"Type XEFR here"}],"autoGenerateId":true,"indexes":[{"attributeIds":["a3948ea7-82db-4d7a-9133-cf898d696f48","b564375f-876a-49aa-b20e-19f5ea0aefbf","56d94c01-d68f-4ed8-83fe-9f21788445ea"],"concatenatedFieldName":"testIndex"}],"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"3da5aee9-17b3-447a-98b0-33930cbb9237","name":"Adjustments US NFI","description":"US NFI Adjustments ($)","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"658f2ca3-c529-40da-b01f-5ed916bb344f","name":"Candidate","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"f1e74596-0258-425c-bc98-d6e2498ab081","attributeId":"a7f7c717-959a-4dbd-abf7-2f6c8827b72b","allowOther":true}},{"id":"d79daeea-56d8-465d-8215-d51252cd4488","name":"CompanyName","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"f1e74596-0258-425c-bc98-d6e2498ab081","attributeId":"e8bd17a7-b576-4973-8ad8-bb858fa7125a"}},{"id":"83ce49fb-dcc0-45e0-9543-a3a6bc72a362","name":"Placement","type":"STRING"},{"id":"98803d76-42ed-4f21-a99f-a47b5f596f3d","name":"InvoiceDate","type":"DATE"},{"id":"f8bbe4cd-ec33-4652-895e-fefb1497e243","name":"Currency","type":"DROP_DOWN","additionalOptions":{"items":["CAD","USD"]}},{"id":"320a8d40-ceed-46c8-afe7-c4dc79840eb5","name":"LinePrice","type":"NUMBER"},{"id":"6e263bf0-7090-41ca-9c27-652264986686","name":"ChargeCode","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"3029f855-9e82-43e0-ae04-ff3da948c936","attributeId":"0a6bf19b-147c-428b-9607-c7029edaebf9"}},{"id":"81ae6912-9611-4fc1-b833-0db80bb27459","name":"Source","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"cc3896cc-f921-470a-adb7-f6c50f01ad1e","name":"Aux Date Ranges","description":"","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"db105739-574e-4262-b266-e376d6367a1a","name":"Name","type":"STRING"},{"id":"032db808-5503-498d-a1c0-502ee11e70e6","name":"Start","type":"DATE_TIME"},{"id":"7e131976-a294-43df-936c-c0ce4fbd10c4","name":"End","type":"DATE_TIME"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"3c759224-f7b5-40c3-ad24-621612e9b915","name":"Aux Log Retention","description":"","attributes":[{"id":"04ca0c99-e894-4efc-81dd-c9a5380e88b9","name":"Name","type":"STRING","isCloneable":false},{"id":"9c1bd75b-08c7-492d-9be8-4b3b749d0f90","name":"Max Age","type":"STRING","isCloneable":true},{"id":"ba9c044c-995f-49c8-9836-a33d3bda3990","name":"Max Count","type":"NUMBER","isCloneable":true}],"autoGenerateId":true,"enableCloning":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"c7b70d16-57cf-4ef1-a544-906962b89196","name":"Aux Logs","description":"","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"a4be02e5-35a0-41ef-a11e-d85856ea67cc","name":"Success","type":"BOOLEAN"},{"id":"8bfc6db3-436e-44a9-ab56-35e6bcb45cc8","name":"Pipeline Name","type":"STRING"},{"id":"f509cbf9-25d6-47db-b928-39762dfe0ea3","name":"Loader Source","type":"STRING"},{"id":"685c1f36-4553-44e1-85fc-942d2f582dfe","name":"Loader Dataset Name","type":"STRING"},{"id":"92cdcb77-ad5c-4588-950f-a8d2b2d85029","name":"Details","type":"TEXT_AREA"},{"id":"b0cf7e17-d0d5-4caf-bacb-062aff7fdb6a","name":"Start","type":"DATE_TIME"},{"id":"61328ffa-696b-461c-b3bb-37959bd4020f","name":"End","type":"DATE_TIME"},{"id":"86ed352b-ecfa-4024-a3cc-a40244cb81de","name":"Trigger","type":"STRING"},{"id":"5b3fc0e6-3c6b-40f9-8b31-d059e48d5a89","name":"Refresh Interval","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"61d7fdb2-15e2-436c-a43a-4575dcab176b","name":"Bullhorn Appointments","description":"","attributes":[{"id":"9741d784-3d2c-4470-9d1f-3d0281d25441","name":"Appointment ID","type":"NUMBER"},{"id":"25669552-bc1d-4319-a42e-e47826412e62","name":"Type","type":"STRING"},{"id":"26a3b6c5-99e5-4aa0-8432-af256922b4ee","name":"Create Date","type":"STRING"},{"id":"6ad2cf21-4f8b-4713-9dc2-ce59db56cf6f","name":"Create Time","type":"STRING"},{"id":"b4d2378e-09fd-4b4b-b13e-d4f6c8ce323a","name":"Job ID","type":"NUMBER"},{"id":"8cfc53fb-c7f0-4aa2-a4cb-382b1c6b6bc4","name":"Job Title","type":"STRING"},{"id":"3c203fb7-c10f-4862-b1dd-1fce8a795824","name":"Candidate","type":"STRING"},{"id":"6f26305a-3eb5-4f1a-a13e-3157da49ad4f","name":"Consultant","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"28ddc08c-f03b-4d43-9d1f-2ef4d55a78a1","name":"Bullhorn Candidates","description":"Bullhorn Candidates","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"c794169e-7396-41e2-b6c7-9b0cdb049578","name":"Bullhorn ID","type":"STRING"},{"id":"ecc56604-31da-4e5e-893d-f8e2eff2f598","name":"Candidate","type":"STRING"},{"id":"eba8891c-fe65-43d4-904a-1f750b7605d4","name":"Consultant","type":"STRING"},{"id":"ae6e35e5-b618-4ca3-a5c2-7180f66dc7c1","name":"Status","type":"STRING"},{"id":"88b15fcc-4471-48f1-a8f4-38753d90d344","name":"Create Date","type":"DATE"},{"id":"bc2bef10-289b-4333-8559-f9db16c6f694","name":"Create Time","type":"STRING"},{"id":"68b1c940-78aa-4283-9fee-1f46106d543b","name":"Employee Type","type":"STRING"},{"id":"572fca60-be41-45ed-bfbd-2b0ed2b29ad3","name":"Country","type":"STRING"},{"id":"cba764c1-d617-4d38-912a-d691472765eb","name":"City","type":"NUMBER"},{"id":"d8a3cf58-42f1-48c1-88eb-a31d7d00ac0a","name":"Custom Text 5","type":"STRING"},{"id":"519a5c4d-bce2-4a8e-bcef-11e387c66699","name":"Employment Preference","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"44b1205e-f1c2-415e-b506-2c52c6714b94","name":"Bullhorn Candidates","description":"Candidates created in the last week or so","attributes":[{"id":"92442322-5a7e-4921-9c2b-0f94ff3d8ada","name":"Bullhorn ID","type":"STRING"},{"id":"6a3e7c62-a76f-49a6-b934-b9fcfdaff5d2","name":"Status","type":"STRING"},{"id":"41127efa-e0bf-4997-a643-d2af7bfe9837","name":"Create Date","type":"DATE"},{"id":"7fb3e4bd-2438-450a-8d4e-bc57512e4846","name":"Create Time","type":"STRING"},{"id":"1447e8d5-652c-426b-a72d-980c12258c27","name":"Candidate","type":"STRING"},{"id":"2bcae461-455f-4fd2-bc7a-f8077828160d","name":"Consultant","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"23443c00-ac6a-4f80-96ce-e9431e4151ee","name":"Bullhorn Clients","description":"Bullhorn Client Corporations","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"7123bec8-2722-4b99-8ce6-43543b8c080c","name":"Client ID","type":"STRING"},{"id":"88240490-293f-44b4-88a4-c023d7a68396","name":"Client","type":"STRING"},{"id":"d3c9344d-e635-415b-ac19-3fb366592298","name":"Status","type":"STRING"},{"id":"d4075e03-bcd5-4e2f-96b9-c6a1db62cf32","name":"Consultant","type":"STRING"},{"id":"e9295d97-81bc-430c-9e1b-18a219b81cd8","name":"Country ID","type":"STRING"},{"id":"e457bd1f-4442-4147-9bbc-e12b3cfd6f46","name":"City","type":"STRING"},{"id":"c98228cc-0329-4f42-8048-0990ccdf3e51","name":"Create Date","type":"DATE"},{"id":"99133f7f-9a8c-4656-916f-2346badb5273","name":"Create Time","type":"STRING"},{"id":"cf3efb0a-bce9-4364-a72f-5188d3e236c0","name":"Modified Date","type":"DATE"},{"id":"3cd164cb-da03-4a85-bcf9-529c3318de8d","name":"Modified Time","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"e9b60805-fe77-4f06-90e6-e12d29a73874","name":"Bullhorn Consultant Actions","description":"","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"1e064921-80fc-4909-abbc-ab3b6976e6cf","name":"Action","type":"STRING"},{"id":"53c99189-c550-45b4-b277-cbda07c6ee58","name":"Consultant ID","type":"STRING"},{"id":"8b0f02a2-87ca-472a-a208-abf67f4213a7","name":"Consultant","type":"STRING"},{"id":"7e935a87-289d-47db-bc07-1635eea9a18c","name":"Date Added","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"f73a3034-f349-4387-bd07-0cbb6725e6f2","name":"Bullhorn Consultant Details","description":"","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"b8e494a7-cd0d-4db5-90ec-e80ae5d34e04","name":"Bullhorn ID","type":"STRING"},{"id":"4dbf7ae1-1c55-4e1d-a160-b58d54bd1870","name":"Consultant","type":"STRING"},{"id":"ea1e1c3c-ea3d-430c-b95c-72e4b9dabdf6","name":"Role","type":"STRING"},{"id":"619a0190-3160-49f2-8f15-e289788c2b7e","name":"Departments","type":"STRING"},{"id":"78c479f2-6895-4d83-9072-d694ae6fd7ef","name":"City","type":"STRING"},{"id":"553c60a8-c7cc-4340-937a-30b113212547","name":"Country","type":"STRING"},{"id":"4f967fa5-7051-47bf-9fa5-5ebe744b3838","name":"Modified Date","type":"DATE"},{"id":"a459fd89-26cb-4577-b004-ec98561f9a04","name":"Modified Time","type":"STRING"},{"id":"7ef2de79-0c4e-4d45-afa8-c27e782be6cd","name":"Source","type":"STRING"}],"autoGenerateId":true,"indexes":[],"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"00b2abc8-1fa8-4987-8671-70d0b6e22e0c","name":"Bullhorn Consultant Teams","description":"Track which team a consultant is in","readRoles":["admin","finance"],"writeRoles":["admin","finance"],"attributes":[{"id":"9ac80bc9-53e0-4e9b-82af-21a3add60bc0","name":"Consultant","type":"STRING","additionalOptions":{"schemaId":"f73a3034-f349-4387-bd07-0cbb6725e6f2","attributeId":"4dbf7ae1-1c55-4e1d-a160-b58d54bd1870","allowOther":true}},{"id":"edc7a6f5-8d25-49e1-909a-448c680c899b","name":"Team","type":"STRING","additionalOptions":{"schemaId":"795b2480-c4c5-46b9-877d-0d43b8f4ebe0","attributeId":"4def0481-7349-4d42-a581-ba5161f4e5f7","allowOther":true}},{"id":"23048ea5-d44e-43b6-8e9d-62be44e9a9b9","name":"Team Lead","type":"STRING"}],"autoGenerateId":true,"indexes":[{"attributeIds":["9ac80bc9-53e0-4e9b-82af-21a3add60bc0"]}],"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"c2c53d81-fbae-425d-8cf9-d97ed40d3010","name":"Bullhorn Jobs","description":"","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"7b9addbd-0106-4399-94cb-e4a8f46a0476","name":"Job ID","type":"STRING"},{"id":"b7c7051e-b942-4cb3-b826-c00b2deb1847","name":"Consultant","type":"STRING"},{"id":"2de48ae3-a711-464d-ac46-21d8e12b5b7e","name":"Client","type":"STRING"},{"id":"0a65d307-9ba4-43df-9509-574c32773dc1","name":"Employment Type","type":"STRING"},{"id":"fdcdb880-899b-4265-9e46-4ebda7aeabb7","name":"Status","type":"STRING"},{"id":"fed0854a-5e71-4081-b84a-c98cdc50eefd","name":"Country","type":"STRING"},{"id":"7a5c1701-a1ea-4aac-9cf0-681d697148ed","name":"City","type":"STRING"},{"id":"e20af22b-2d59-4f6f-956a-2050b05b6b15","name":"Create Date","type":"STRING"},{"id":"c9d2f3bb-79f6-45bf-ad3d-45a5e0d05f4b","name":"Create Time","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"b203ea25-4539-41f6-81eb-b67454a263ed","name":"Dashboard","description":"Placeholder for the consultant leader boards","attributes":[],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"69637012-e517-444b-ba58-0daab510ca57","name":"FOREX Forecast Date","description":"Used to flag from which date forecasts are applied","attributes":[{"id":"b3b392ea-c7c1-4d13-9f44-d85a4a7892ec","name":"Forecast Date From","type":"DATE"}],"autoGenerateId":true,"indexes":[{"attributeIds":["b3b392ea-c7c1-4d13-9f44-d85a4a7892ec"]}],"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"6f527503-ca52-4121-93ef-aa8b40537f1b","name":"FOREX GBP","description":"Daily Forex rates","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"41886f0a-1e6d-417e-bf53-efd6a0f0482c","name":"Year","type":"STRING"},{"id":"60b59e74-4f6d-4e1d-ad0a-63df8433301e","name":"Month","type":"DROP_DOWN","additionalOptions":{"items":["01-Jan","02-Feb","03-Mar","04-Apr","05-May","06-Jun","07-Jul","08-Aug","09-Sep","10-Oct","11-Nov","12-Dec"]}},{"id":"38a6bf55-b555-4484-9f86-a90593dde033","name":"Day","type":"NUMBER"},{"id":"eeb627d6-445b-4b4a-aa85-f524269de6c0","name":"Symbol","type":"DROP_DOWN","additionalOptions":{"items":["£","$","kr","SGD","Fr","€","CHF","PLN","AUD","SEK"]}},{"id":"d1200ce5-4734-495e-bcb5-0246cb6aeb51","name":"GBP Rate","type":"NUMBER"}],"autoGenerateId":true,"indexes":[{"attributeIds":["41886f0a-1e6d-417e-bf53-efd6a0f0482c","60b59e74-4f6d-4e1d-ad0a-63df8433301e","38a6bf55-b555-4484-9f86-a90593dde033","eeb627d6-445b-4b4a-aa85-f524269de6c0"],"concatenatedFieldName":"gbpFXLookup"},{"attributeIds":["eeb627d6-445b-4b4a-aa85-f524269de6c0"]}],"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"71d53482-25ce-4ca6-b0f3-31829ad07e9a","name":"FOREX USD","description":"This is now used","attributes":[{"id":"193e5f4c-74e2-465e-9082-fa97403f21fa","name":"Year","type":"STRING"},{"id":"1ab59395-56e2-4eb3-939c-9461dbedfc30","name":"Month","type":"DROP_DOWN","additionalOptions":{"items":["01-Jan","02-Feb","03-Mar","04-Apr","05-May","06-Jun","07-Jul","08-Aug","09-Sep","10-Oct","11-Nov","12-Dev"]}},{"id":"9cdf639c-8836-4332-924b-b412339e5281","name":"Day","type":"STRING"},{"id":"6dc401f9-edb2-4a7a-ab41-7f19aff345f6","name":"Symbol","type":"DROP_DOWN","additionalOptions":{"items":["CAD"]}},{"id":"a199508a-f51e-4ec9-9a2b-1638691ed2ca","name":"USD Rate","type":"NUMBER"}],"autoGenerateId":true,"indexes":[{"attributeIds":["193e5f4c-74e2-465e-9082-fa97403f21fa","1ab59395-56e2-4eb3-939c-9461dbedfc30","9cdf639c-8836-4332-924b-b412339e5281","6dc401f9-edb2-4a7a-ab41-7f19aff345f6"],"concatenatedFieldName":"usdFXLookup"},{"attributeIds":["6dc401f9-edb2-4a7a-ab41-7f19aff345f6"]}],"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"d8e5853c-0ffc-47c5-8166-c5ee62f9da5d","name":"Leaderboard Actions","description":"Required by Leaderboards in order to create new Target records","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"4a92c4c7-3ec3-4a16-b524-860f6b4a4c75","name":"Action","type":"STRING"},{"id":"da76f998-5c49-4143-b149-0153630779c2","name":"Source","type":"STRING"},{"id":"eaddc413-1c72-4734-a3e0-5e643d7e294b","name":"Notes","type":"STRING"},{"id":"3ce1ec84-5ddf-457e-bc03-4dad4407a48e","name":"Status","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"8311ae6c-34a0-471d-8275-6d662d6954f3","name":"Leaderboard CVS Sent","description":"View of the Bullhorn data set that is used to drive this metric","attributes":[{"id":"f129dda0-ebc6-4501-96b4-84be27eadd46","name":"id","type":"STRING"},{"id":"b8371ecb-f31c-4995-a8f3-ccd6928f7bcc","name":"Title","type":"STRING"},{"id":"1ff4a55e-bf11-4294-a2e7-a8e3159e9f79","name":"Client","type":"STRING"},{"id":"fcc80e6d-79e9-407f-9086-b136861be34c","name":"Candidate","type":"STRING"},{"id":"7075e956-4943-4fdb-b2af-3477f46593fc","name":"Consultant","type":"STRING"},{"id":"cfb3f5d6-6593-464b-9ffb-97f2b6af1422","name":"startDate","type":"DATE"},{"id":"91323bc5-e024-4ec4-9763-03842d59dd72","name":"startTime","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"d3f9381f-e86d-44b2-a2df-129f49bc9039","name":"Leaderboard Client Contacts","description":"View of the Bullhorn data set that is used to drive this metric","attributes":[{"id":"243ca923-1446-4bc3-927f-59051d803730","name":"id","type":"STRING"},{"id":"f13f5289-2459-4f83-b850-f16e7695539b","name":"Name","type":"STRING"},{"id":"209477c7-be66-4d7e-95c3-f6eac1d42eb3","name":"startDate","type":"DATE"},{"id":"c43b3b82-61bc-47c9-a973-03f5cce9b55b","name":"startTime","type":"STRING"},{"id":"314a46dd-b65d-4d13-abc8-6b779f5de58a","name":"Consultant","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"59c874a8-b480-4f24-bbab-cffc9deabfe9","name":"Leaderboard Metrics Roles","description":"Staff member roles, used to create new Targets","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"409ac143-8680-4270-bfab-6717d222dfd6","name":"Role","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"029ed755-6cda-49e8-b34b-95b49a0866ae","name":"Leaderboard Role Action Targets","description":"Used by the AUX project for the Leaderboards","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"b302dfd2-2982-44e2-8593-35d33e70b8bc","name":"Role","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"59c874a8-b480-4f24-bbab-cffc9deabfe9","attributeId":"409ac143-8680-4270-bfab-6717d222dfd6"}},{"id":"359cb5a5-9dac-4b39-8295-8077f1e10352","name":"Action","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"d8e5853c-0ffc-47c5-8166-c5ee62f9da5d","attributeId":"4a92c4c7-3ec3-4a16-b524-860f6b4a4c75"}},{"id":"89cb7f0a-5cf2-4634-b5d0-a851fbbd5bee","name":"Weekly Target","type":"NUMBER"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"bc482292-4b82-454a-9a25-05cb471f7f16","name":"Leaderboard Vacancies","description":"Used By The Aux Project For The Leaderboards","attributes":[{"id":"d1ede505-3077-4808-83c1-2bee9287cc43","name":"id","type":"STRING"},{"id":"78c5fe41-75b7-4dea-91f2-8320cd77ed23","name":"EmploymentType","type":"STRING"},{"id":"15e47655-85ac-4b81-b0f0-16691ef08dfd","name":"Title","type":"STRING"},{"id":"37964dd2-17f4-4dae-8881-cf42c9653858","name":"Consultant","type":"STRING"},{"id":"eb390acb-5248-4b8d-9fae-bcd1b5c114a0","name":"StartDate","type":"DATE"},{"id":"269f4f74-82c3-47ba-8336-ca2bfcfc715c","name":"StartTime","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"f03c74be-d0c9-4322-92d9-dcb64a265ab8","name":"Leaderboard Wheels","description":"Used to populate a drop down that is then used by Aux project","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"5599c163-9954-45b2-a263-a2b1170b0edd","name":"Wheel","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"39889598-5fe2-4a50-aaca-ed52b0815f19","name":"Metrics Candidate Splits","description":"Potentially redundant","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"6916b742-a251-43d3-9baa-6a758777844f","name":"Candidate Name","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"9619607a-ef0f-434a-99d2-dcc41e26d801","attributeId":"05063a36-03b5-4fbf-8f63-ad27a6d8ef31"}},{"id":"6c79e252-efa7-44bc-98dc-2d4816c72455","name":"Finished","type":"DROP_DOWN","additionalOptions":{"items":["Y","N"]}},{"id":"f6d7d839-e25b-46fe-9bd2-f260fbd75de5","name":"Consultant","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"454937d1-0329-495d-aaa3-61d86144469c","attributeId":"fd38fd02-d5ec-4d03-8a3c-2a38ebcdecd6"}},{"id":"f46722b6-869d-49eb-96bf-85c9f7f10197","name":"Split","type":"NUMBER"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"3029f855-9e82-43e0-ae04-ff3da948c936","name":"Metrics Charge Codes","description":"How the various candidate states roll up to Contract or Perm\nTemporarily added Retainer and Missing whilst Client decides on US data config","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"0a6bf19b-147c-428b-9607-c7029edaebf9","name":"ChargeCode","type":"STRING"},{"id":"2fa7b8c0-08f5-4a67-b5b4-a8d4579a7b54","name":"ChargeCodeDescription","type":"STRING"},{"id":"02168f41-62b2-4c9f-af6e-14d3ec829ccd","name":"Type","type":"DROP_DOWN","additionalOptions":{"items":["Contract","Perm","Retainer","Missing"]}}],"autoGenerateId":true,"indexes":[{"attributeIds":["0a6bf19b-147c-428b-9607-c7029edaebf9"]}],"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"9ed7f42e-380d-490a-bd21-85e36ea7abbf","name":"Metrics Retainers","description":"","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"2d2ed6cd-097b-415b-bc9f-5b1390dc6206","name":"Client","type":"STRING"},{"id":"dbd30a17-87a0-42e1-97d3-39d3571519ce","name":"Consultant","type":"STRING"},{"id":"c0495e98-3e00-406e-99f0-9ed86a7a00b6","name":"Nos","type":"NUMBER"},{"id":"ac19949e-d58a-4672-9b5b-8891cb9a2cd7","name":"Country","type":"STRING"},{"id":"b97033a1-2412-4c0f-97d5-e0deeed252b3","name":"Retainer","type":"NUMBER"},{"id":"dfb10547-f409-486d-8d79-de5eee50c5ae","name":"Retainer Invoice Nos","type":"STRING"},{"id":"d7a63c05-e8b9-4761-9b1d-d867e146db7f","name":"Invoice Date","type":"DATE"},{"id":"a2ea943e-4510-498b-9635-4e45ddba684e","name":"Expiry Date","type":"DATE"},{"id":"d2bccea7-05d5-43f0-8f54-f481c6d611da","name":"Filled Date","type":"DATE"},{"id":"4830e99e-7fa0-4d88-8d69-3330a21d82b6","name":"Placement","type":"STRING"},{"id":"522ce28f-ff1f-4d1e-8315-8d30852fd7b0","name":"Fee","type":"NUMBER"},{"id":"ad6b9087-abf9-432b-bf1d-73c7d3ae761d","name":"Inv Nos","type":"STRING"},{"id":"90184bf1-dfc6-44ad-b514-c61959721797","name":"Inv Date","type":"DATE"},{"id":"35855546-9e9c-4754-a563-1ece2a2f9f1a","name":"Status","type":"DROP_DOWN","additionalOptions":{"items":["Filled","Expired","In Progress"]}},{"id":"b6895c62-a17f-4bdc-87c2-6ce496820800","name":"Closed ?","type":"DROP_DOWN","additionalOptions":{"items":["Y","N"]}},{"id":"7cb45b6b-281d-4b37-b7f2-e1bb892f6179","name":"Comments","type":"TEXT_AREA"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"795b2480-c4c5-46b9-877d-0d43b8f4ebe0","name":"Metrics Teams","description":"Bullhorn teams, used within reporting","readRoles":["admin","finance"],"writeRoles":["admin","finance"],"attributes":[{"id":"4def0481-7349-4d42-a581-ba5161f4e5f7","name":"Team","type":"STRING"},{"id":"322f031c-6c77-4573-bbcd-2fb9dfc665e2","name":"Team Lead","type":"STRING","additionalOptions":{"schemaId":"f73a3034-f349-4387-bd07-0cbb6725e6f2","attributeId":"4dbf7ae1-1c55-4e1d-a160-b58d54bd1870"}}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"1c48fbf6-d991-4cfa-a8ad-8ad52048f44b","name":"Metrics Working Days","description":"","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"ab1fd869-ec91-4b9b-b8bf-408f4c0498ac","name":"Country","type":"STRING"},{"id":"891a4184-1cd2-4089-ac40-7bfba08f18b9","name":"Year","type":"STRING"},{"id":"89a27a99-bed9-48f2-9e7c-96bc0926973e","name":"Month","type":"STRING"},{"id":"53fa4b86-99d1-4dcc-b58d-56b23685b1ff","name":"Nos Days","type":"NUMBER"}],"autoGenerateId":true,"indexes":[{"attributeIds":["ab1fd869-ec91-4b9b-b8bf-408f4c0498ac","891a4184-1cd2-4089-ac40-7bfba08f18b9","89a27a99-bed9-48f2-9e7c-96bc0926973e"],"concatenatedFieldName":"workingDaysLookup"}],"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"20571211-b521-4bc4-9af2-6a34fd72f3a5","name":"New Deals Country","description":"","attributes":[{"id":"e9768aa2-56e5-44cf-b05d-2f3f8bbed094","name":"Country","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"7367db37-5b35-4235-ac9f-ab21d6a28756","name":"New Deals Currency","description":"","attributes":[{"id":"b1014077-dfb8-4aa7-9513-c79e0332f988","name":"Currency","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"41604b2b-a072-4c34-827e-e42a6ae90bab","name":"New Deals Data","description":"Manually entered data that is the source for all the New Deals Pivors","attributes":[{"id":"d760158c-d165-4522-ac3d-e3a528637b7b","name":"Candidate","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"44b1205e-f1c2-415e-b506-2c52c6714b94","attributeId":"1447e8d5-652c-426b-a72d-980c12258c27"}},{"id":"f2efc6c0-70f8-4b50-98ec-5c70a981bc7e","name":"Company","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"23443c00-ac6a-4f80-96ce-e9431e4151ee","attributeId":"88240490-293f-44b4-88a4-c023d7a68396"}},{"id":"a4e1feea-657d-45e2-a461-1bc73b8912d6","name":"Source","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"6f9015c2-9912-4c7b-97f7-53d303270d77","attributeId":"7d317bd5-838a-4f8d-bd85-7bf1b0c3396a"}},{"id":"59162bcc-c1ab-4fa5-9552-8701867775f5","name":"Nos Retainers","type":"NUMBER"},{"id":"bdf0d138-70cf-4868-932e-b0992fa4ec0a","name":"Deal Currency","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"7367db37-5b35-4235-ac9f-ab21d6a28756","attributeId":"b1014077-dfb8-4aa7-9513-c79e0332f988"}},{"id":"0de4d783-8f8f-46e9-893b-ae938ece25f8","name":"Deal Value","type":"NUMBER"},{"id":"0a226ad2-5527-43f7-af21-f1f3922e2ef0","name":"Retainer","type":"NUMBER"},{"id":"da5450fa-bc95-4260-8c66-95f1a1960053","name":"Actual Deal Value","type":"NUMBER","calculatedValueFunction":"attribute[\"Deal Value\"]- attribute[\"Retainer\"]"},{"id":"9a70edb0-8976-4ba9-a33b-fc84de549f86","name":"Year Month","type":"SCHEMA_LOOKUP","additionalOptions":{"items":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"schemaId":"b05c6485-9bc4-46ae-8005-fd986fcf8a7e","attributeId":"a223301e-298e-4b57-af18-e80b6c87311a"}},{"id":"0266af94-b8b0-4633-a5f5-d073a848bc0c","name":"CK_GBP_RATE","type":"STRING","calculatedValueFunction":"attribute[\"Year Month\"]+attribute[\"Deal Currency\"]"},{"id":"dfea2a46-318f-4f83-9d5d-6f17fca183b3","name":"Exchange Rate","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"3f5afae7-0ef0-40a2-9bce-73129a225bdb","attributeId":"3e8be86e-5f5e-4425-b2c7-938f6a50192f","filterSchemaLookup":{"schemaAttributeId":"0266af94-b8b0-4633-a5f5-d073a848bc0c","operator":"\u003d","targetAttributeId":"beac3a9d-5532-485b-8ddd-a4abb4887ce6"}}},{"id":"8fa224f5-d07f-40d0-9e7d-942d21a57bdd","name":"Candidate Owner","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"f73a3034-f349-4387-bd07-0cbb6725e6f2","attributeId":"4dbf7ae1-1c55-4e1d-a160-b58d54bd1870"}},{"id":"b97b9de6-131c-4648-91ed-a051e1a180da","name":"Split","type":"NUMBER"},{"id":"3e8aeca3-2dba-4ea3-8b4d-c38a44865f92","name":"Retainer Split","type":"NUMBER"},{"id":"c11fbd7c-9c4b-44d6-aa2d-fbcc9e66d344","name":"Extension","type":"DROP_DOWN","additionalOptions":{"items":["Y","N"]}},{"id":"7d3a879c-93bb-47c7-a9ac-1ce6d32fb78a","name":"Team","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"00b2abc8-1fa8-4987-8671-70d0b6e22e0c","attributeId":"edc7a6f5-8d25-49e1-909a-448c680c899b","filterSchemaLookup":{"schemaAttributeId":"8fa224f5-d07f-40d0-9e7d-942d21a57bdd","operator":"\u003d","targetAttributeId":"9ac80bc9-53e0-4e9b-82af-21a3add60bc0"}}},{"id":"1b370436-0853-498f-b793-cd7ed8676d6b","name":"Team Lead","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"00b2abc8-1fa8-4987-8671-70d0b6e22e0c","attributeId":"23048ea5-d44e-43b6-8e9d-62be44e9a9b9","filterSchemaLookup":{"schemaAttributeId":"7d3a879c-93bb-47c7-a9ac-1ce6d32fb78a","operator":"\u003d","targetAttributeId":"edc7a6f5-8d25-49e1-909a-448c680c899b"}}},{"id":"4a4acacc-7e75-4128-b9e2-83351946d140","name":"Candidate Country","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"20571211-b521-4bc4-9af2-6a34fd72f3a5","attributeId":"e9768aa2-56e5-44cf-b05d-2f3f8bbed094"}},{"id":"b2602a9f-e483-46f5-af33-60e3cde1e593","name":"Client Country","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"20571211-b521-4bc4-9af2-6a34fd72f3a5","attributeId":"e9768aa2-56e5-44cf-b05d-2f3f8bbed094"}},{"id":"77dbdfcf-4c2a-4204-b45f-d56633b79b9b","name":"First Deal","type":"DROP_DOWN","additionalOptions":{"items":["Y","N"]}},{"id":"51742487-1c67-472c-9799-bfc84c8c47a0","name":"New Customer","type":"DROP_DOWN","additionalOptions":{"items":["Y","N"]}}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"4409a669-a6dd-462e-9a0f-3138d613e3d6","name":"New Deals Deal Type","description":"","attributes":[{"id":"cfb377ec-551f-48ac-a773-f38841645de6","name":"Deal Type","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"3f5afae7-0ef0-40a2-9bce-73129a225bdb","name":"New Deals HMRC Rates","description":"","attributes":[{"id":"cb8acef5-4ad0-4620-8519-39827c5919ab","name":"Currency","type":"SCHEMA_LOOKUP","additionalOptions":{"schemaId":"7367db37-5b35-4235-ac9f-ab21d6a28756","attributeId":"b1014077-dfb8-4aa7-9513-c79e0332f988"}},{"id":"f5b59a01-5c74-4bc8-8d23-22e0781d6829","name":"Year Month","type":"SCHEMA_LOOKUP","additionalOptions":{"items":["2023"],"schemaId":"b05c6485-9bc4-46ae-8005-fd986fcf8a7e","attributeId":"a223301e-298e-4b57-af18-e80b6c87311a"}},{"id":"3e8be86e-5f5e-4425-b2c7-938f6a50192f","name":"GBP Rate","type":"NUMBER"},{"id":"beac3a9d-5532-485b-8ddd-a4abb4887ce6","name":"CK_YearMonthCurrency","type":"STRING","calculatedValueFunction":"attribute[\"Year Month\"]+attribute[\"Currency\"]"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"b05c6485-9bc4-46ae-8005-fd986fcf8a7e","name":"New Deals Months","description":"Sorted Months","attributes":[{"id":"9e3e22f0-4d30-4b48-bd68-f10bf8c9f674","name":"Year","type":"DROP_DOWN","additionalOptions":{"items":["2023"]}},{"id":"f67976a1-5cd6-4c9f-93d5-f85fb72c16eb","name":"Month Nos","type":"DROP_DOWN","additionalOptions":{"items":["01","02","03","04","05","06","07","08","09","10","11","12"]}},{"id":"1694101d-027f-4b2a-b6b4-593a564d8884","name":"Month Short","type":"DROP_DOWN","additionalOptions":{"items":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}},{"id":"a223301e-298e-4b57-af18-e80b6c87311a","name":"YYYY Month Nos","type":"STRING","additionalOptions":{"items":[]},"calculatedValueFunction":"attribute[\"Year\"]+\"-\"+attribute[\"Month Nos\"]"},{"id":"71193332-1d57-4029-8356-fa7350b31ba6","name":"YYYY Month Short","type":"STRING","calculatedValueFunction":"attribute[\"Year\"]+\"-\"+attribute[\"Month Short\"]"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"6f9015c2-9912-4c7b-97f7-53d303270d77","name":"New Deals Sources","description":"","attributes":[{"id":"7d317bd5-838a-4f8d-bd85-7bf1b0c3396a","name":"Source","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"b41fa69a-024d-41f4-9e63-6b29039e6f36","name":"Reporting Year","description":"Used to set the Year reporting context for all schemas for that user in that instance","attributes":[{"id":"fd1414aa-092c-406d-8d22-6ab88d63eac9","name":"Reporting Year","type":"STRING"},{"id":"39a2756e-2801-4e98-8ef0-69dc47010126","name":"Start Date","type":"DATE","calculatedValueFunction":"attribute[\"Reporting Year\"]+\"-01-01\""},{"id":"4f9f6866-238c-4379-873a-a3255748d474","name":"End Date","type":"DATE","calculatedValueFunction":"attribute[\"Reporting Year\"]+\"-12-31\""},{"id":"9450ae0f-d579-417e-a6f7-04b4343d0617","name":"Current","type":"BOOLEAN"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"f699b63e-c176-48d7-94a3-ba9d0b5ffa2e","name":"TSP UK Contractor Invoices Tracker","description":"","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"68b04746-6a64-48d5-a32d-55be74d2218f","name":"InvoiceDate","type":"STRING"},{"id":"07199028-28be-4428-bdf0-dc457b0f8f78","name":"Candidate","type":"STRING"},{"id":"9ba12092-8b69-4226-adf8-646d87005b7e","name":"CompanyName","type":"STRING"},{"id":"cb342d05-2e64-4c54-9e17-51bc22f22cc0","name":"Currency","type":"STRING"},{"id":"a4b0d687-537c-4e98-a59a-784fd56adc59","name":"LinePrice","type":"STRING"},{"id":"4426ec67-3c73-40f2-8dc8-8dbd43eaae34","name":"Placement","type":"STRING"},{"id":"d1656978-3bdd-4033-8c0f-4bbddfb752af","name":"ChargeCode","type":"STRING"},{"id":"4d925bf3-fc52-4a90-9a06-f941d0304693","name":"Source","type":"STRING"},{"id":"214e3178-13de-4940-be8c-4dff17a6a9ab","name":"Country","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"74633e84-deba-4720-8181-c07629a1c665","name":"TSP UK Invoice Tracker","description":"Read only view of the actual data used in PBI report","readRoles":["admin"],"writeRoles":[],"attributes":[{"id":"3ddba065-85fc-4284-a125-1f3f36995fcc","name":"InvoiceDate","type":"DATE"},{"id":"925b1817-616e-4041-8a1c-226e7974979c","name":"Placement","type":"STRING"},{"id":"0b53493f-debc-46fd-9acf-b1db2e233ff3","name":"Candidate","type":"STRING"},{"id":"ff566028-d412-4244-90e7-e0afa1b9166a","name":"CompanyName","type":"STRING"},{"id":"d1caf1e2-ff21-41ee-ac26-d2d897df1954","name":"Currency","type":"STRING"},{"id":"2eebea24-37f3-4fd5-b565-be45bf60759c","name":"LinePrice","type":"NUMBER"},{"id":"cd667d65-991f-4e9c-b4d4-6b3383541031","name":"ChargeCode","type":"STRING"},{"id":"4a7fb5ca-6e3a-447e-ab86-569c0f91a756","name":"Country","type":"STRING"},{"id":"5d3b25bc-350d-46c5-b07f-305f125a446d","name":"Source","type":"STRING"}],"autoGenerateId":true,"indexes":[{"attributeIds":["925b1817-616e-4041-8a1c-226e7974979c","0b53493f-debc-46fd-9acf-b1db2e233ff3"],"concatenatedFieldName":"placementCandidateLookup"}],"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"f05f286f-bc87-4c0f-8684-1549a07f7059","name":"TSP UK Placement Forecast","description":"","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"2d376bdc-a4c2-4e42-a36c-ea50535b08d4","name":"Placement","type":"STRING"},{"id":"864b14c0-bfc4-4010-9123-ead0e98de119","name":"Candidate","type":"STRING"},{"id":"486cf2fd-e1d9-46e6-9e6d-762319706358","name":"Company Name","type":"STRING"},{"id":"21ba7168-b714-45a0-bdde-1ded9e216e5e","name":"Unit","type":"STRING"},{"id":"27f066f8-d0e8-415c-8df3-02bd840f72c7","name":"PC Desc","type":"STRING"},{"id":"4327b651-d18d-4e46-ba35-2bd3605512c6","name":"PC Symbol","type":"STRING"},{"id":"889d0923-58c6-41af-888b-6fd5b3ee2f33","name":"Pay Rate","type":"STRING"},{"id":"ee344988-3c18-4813-83e6-0cbf740c271d","name":"CC Desc","type":"STRING"},{"id":"404d89b8-a3fd-4812-be7e-86bab21c6981","name":"CC Symbol","type":"STRING"},{"id":"10e2acbe-2da0-4ba1-863b-6892fe700dc2","name":"Charge Rate","type":"STRING"},{"id":"072e8283-3488-4b0f-88d5-6fefda7daa6e","name":"Gross Margin","type":"STRING"},{"id":"7e03dba9-dc22-4832-9395-36f3b4275d20","name":"Placement Start","type":"DATE"},{"id":"50d6d35e-d2e0-4bbf-a77d-295e2fcc492b","name":"Placement End","type":"DATE"},{"id":"da9859fd-7f5f-442e-8363-f45f7c629b1a","name":"Forecast Date","type":"DATE"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"b087b785-931b-4340-b182-0a5c5b697415","name":"TSP UK Placements Forecast","description":"","attributes":[{"id":"f8a60428-224b-4b81-8d71-2d949aa4594c","name":"Placement","type":"STRING"},{"id":"d0a97d7b-4ea1-4611-8529-424a6e1bf7e0","name":"Candidate","type":"STRING"},{"id":"923e041c-9684-4bcf-bda4-2e363faf24e4","name":"CompanyName","type":"STRING"},{"id":"c79c274c-acb6-4ec8-8b1c-6ab653bef038","name":"Unit","type":"STRING"},{"id":"fd40cdc6-255a-4abd-b619-1ab4a0e61464","name":"PC Desc","type":"STRING"},{"id":"16b4d2eb-f3d4-46e8-a7dd-865008eac7a1","name":"PC Symbol","type":"STRING"},{"id":"554ac14d-7be0-4016-9665-c5a5d0a95703","name":"Pay Rate","type":"NUMBER"},{"id":"917d4765-a07f-41e9-9694-743fa5b1287e","name":"CC Desc","type":"STRING"},{"id":"7d929119-06af-4eb4-be12-861ff039e8bc","name":"CC Symbol","type":"STRING"},{"id":"8c2c1bb8-edc5-4a57-92a9-4128ee9bbfe7","name":"Charge Rate","type":"NUMBER"},{"id":"a7b2f540-96b4-4e97-94b7-920609efbc01","name":"Placement Start","type":"DATE"},{"id":"ae48614c-66d8-4272-b1bc-53467338f79b","name":"Placement End","type":"DATE"},{"id":"a191b6e2-2380-4dec-9d72-56a693983579","name":"Forecast Date","type":"DATE"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"f8551767-0d58-41db-86c3-df63eef2df6f","name":"TSP UK Placements Tracker","description":"","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"c98bb0d9-1673-4141-9da0-d334c9038fd2","name":"Placement","type":"STRING"},{"id":"fee1a946-0234-43d6-9f58-e57512c9c2a1","name":"Candidate","type":"STRING"},{"id":"1efdfd97-a20a-4424-acba-4852de57ea10","name":"Company","type":"STRING"},{"id":"1843e860-841f-4b93-bd44-7e9396bc9533","name":"Consultant","type":"STRING"},{"id":"2ce4dc9c-8760-4f90-9a92-af47222416b1","name":"Source","type":"STRING"}],"autoGenerateId":true,"indexes":[{"attributeIds":["c98bb0d9-1673-4141-9da0-d334c9038fd2","fee1a946-0234-43d6-9f58-e57512c9c2a1"],"concatenatedFieldName":"placementCandidateLookup"}],"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"7145e736-33b2-49db-ab16-019a13fffa9b","name":"TSP UK Splits","description":"How Candidates are split between consultants","attributes":[{"id":"1a68369b-c041-4ffb-979a-b03511d1f67b","name":"Placement","type":"STRING"},{"id":"2e9227fa-67cc-46c1-9bc6-3dc1ca578d87","name":"ChargeCode","type":"STRING"},{"id":"5220e6f7-d1a4-4c97-a3b9-1c76cc74bb45","name":"Candidate","type":"STRING"},{"id":"72babafb-ab9f-48cf-b7db-6ef11b215dfc","name":"Company","type":"STRING"},{"id":"71c5a1cf-eba3-4776-b9c2-2c363767145e","name":"Consultant","type":"STRING"},{"id":"458e4479-c7c0-426c-9066-c36ab1ef8638","name":"Split","type":"NUMBER"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"81605b44-9aaf-46b6-816e-89012327c09f","name":"TSP US Contractor Invoices Tracker","description":"","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"79d72edc-2a1c-4bd5-93d9-4c80dd6d7360","name":"InvoiceDate","type":"STRING"},{"id":"4aef515e-4753-40ba-add0-d834ab3ce106","name":"Candidate","type":"STRING"},{"id":"3e036474-81bd-4352-86f3-a36c25ac0710","name":"CompanyName","type":"STRING"},{"id":"f9997afe-65a5-4a58-89cb-3301945f5c7f","name":"Currency","type":"STRING"},{"id":"282a72de-19ec-45f3-9e21-d0ef0c2de28d","name":"LinePrice","type":"STRING"},{"id":"2b416668-c824-441a-9cb6-3d81e07e95b5","name":"Placement","type":"STRING"},{"id":"3b7ea17b-28fa-4dc1-9449-44ad2e2577ec","name":"ChargeCode","type":"STRING"},{"id":"d385a0a5-dc9f-424f-bfe3-ec0e3cc165f8","name":"Source","type":"STRING"},{"id":"db3e3aa3-8949-4544-a0de-02057ecb86d8","name":"Country","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"f1e74596-0258-425c-bc98-d6e2498ab081","name":"TSP US Invoice Tracker","description":"","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"7ceded00-871e-46f4-91a0-8981c59ad329","name":"InvoiceDate","type":"DATE"},{"id":"eed0efc4-def0-4e97-aa09-0b732234c6c8","name":"Placement","type":"STRING"},{"id":"a7f7c717-959a-4dbd-abf7-2f6c8827b72b","name":"Candidate","type":"STRING"},{"id":"e8bd17a7-b576-4973-8ad8-bb858fa7125a","name":"CompanyName","type":"STRING"},{"id":"fdf2d2bc-43a7-47f7-9b16-c964e22bb6c4","name":"Currency","type":"STRING"},{"id":"d5588407-c753-4774-aee9-731c22518a95","name":"LinePrice","type":"STRING"},{"id":"1750292c-b21b-4c57-bdd4-a14b4d0dc993","name":"ChargeCode","type":"STRING"},{"id":"637353ec-0baa-4ce8-a56a-c1138e124777","name":"Source","type":"STRING"},{"id":"81a817e2-1919-4599-9dfc-ca1280e62993","name":"Country","type":"STRING"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"81378be9-095f-4b6f-a935-f347616085c1","name":"TSP US Placements Forecast","description":"","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"04aff71b-e4e7-4fe0-9d58-10240e6fe97c","name":"Placement","type":"STRING"},{"id":"29425ea8-9432-435b-a210-6f8b117547b1","name":"Candidate","type":"STRING"},{"id":"1e759528-8e96-4289-b4c1-df6c27eaa134","name":"CompanyName","type":"STRING"},{"id":"eb1f46b6-e04e-4b49-9322-4a68d159a34b","name":"Unit","type":"STRING"},{"id":"3f6fc9ae-1df0-4899-af58-346f9c64bfd1","name":"PC Desc","type":"STRING"},{"id":"2b17e4ec-d203-4ffe-a76a-4f260795aff7","name":"PC Symbol","type":"STRING"},{"id":"0d834b24-9137-4330-b4f8-b447e4428d36","name":"Pay Rate","type":"NUMBER"},{"id":"229cb0fa-0940-41e2-bd00-02efe5f0cead","name":"CC Desc","type":"STRING"},{"id":"0c5eb1b5-ee30-4b5d-b6d8-bd20912439a5","name":"CC Symbol","type":"STRING"},{"id":"5cb0aa0d-df23-4188-8184-cac8f278f7cc","name":"Charge Rate","type":"NUMBER"},{"id":"9a0be2f7-b765-4fff-9b37-a98c9a51ee75","name":"Placement Start","type":"DATE"},{"id":"f0f4f9cb-be34-4c29-8ef7-a0cfba33429b","name":"Placement End","type":"DATE"},{"id":"d9b9ef94-ae57-4916-b3d6-cda2807bfa95","name":"Forecast Date","type":"DATE"}],"autoGenerateId":true,"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"1de15681-5d40-432e-9fa0-3af5a7a8a3ab","name":"TSP US Placements Tracker","description":"","readRoles":["admin"],"writeRoles":["admin"],"attributes":[{"id":"59924083-2c2d-4c2c-b573-88ccd31e4b48","name":"Placement","type":"STRING"},{"id":"f93c4ff0-4aa1-4502-a63e-d2299d7e84c4","name":"Candidate","type":"STRING"},{"id":"fb8af40c-4bc2-4499-b463-e3cbd1584802","name":"Company","type":"STRING"},{"id":"51530f83-4906-49d8-9987-38eb1535fbb6","name":"Consultant","type":"STRING"},{"id":"49593eeb-cc28-4c8e-98a4-a379ccbdf953","name":"Source","type":"STRING"}],"autoGenerateId":true,"indexes":[{"attributeIds":["59924083-2c2d-4c2c-b573-88ccd31e4b48","f93c4ff0-4aa1-4502-a63e-d2299d7e84c4"],"concatenatedFieldName":"placementCandidateLookup"}],"typeClass":"com.xerini.xefr.model.StandardSchema"},{"id":"03507ea6-941a-424f-89a4-2fb990530c69","name":"View Consultant Details","description":"Combines attributes to supply Team, Team Leader and Country of each consultant","attributes":[{"id":"c64fa129-ad05-4f41-82fb-2b20251e3841","name":"Consultant","type":"STRING"},{"id":"6b07b36b-c362-4900-9bbe-6e3f0c18d6c6","name":"Team","type":"STRING"},{"id":"afe424d7-1d78-42ef-abbe-6308deb779bc","name":"Team Lead","type":"STRING"},{"id":"fdec4766-be8f-4c09-bf5e-a1fb197485e9","name":"Country","type":"STRING"}],"pipelineText":"[\n  {\n    $match:{\n      schemaId: $id{Bullhorn Consultant Details}\n    }\n  },\n  {\n    $project: {\n      id: 1,\n      schemaId: $id{View Consultant Details},\n      $id{View Consultant Details.Consultant}: {$toString:$$id{Bullhorn Consultant Details.Consultant}},\n      $id{View Consultant Details.Country}: $$id{Bullhorn Consultant Details.Country}\n    }\n  },\n  {\n    $lookup:{\n      from:\"dataInstances\",\n      localField: $id{View Consultant Details.Consultant},\n      foreignField: $id{Bullhorn Consultant Teams.Consultant},\n      as: \"TeamsLookup\"\n    } \n  },\n  {\n    $set: {\n      \"firstTeamsLookup\": {$arrayElemAt: [\"$TeamsLookup\",0]}\n    }\n  },\n  {\n    $set: {\n      $id{View Consultant Details.Team}: \"$firstTeamsLookup._id{Bullhorn Consultant Teams.Team}\",\n      $id{View Consultant Details.Team Lead}: \"$firstTeamsLookup._id{Bullhorn Consultant Teams.Team Lead}\"\n    }\n  },\n  {\n    $sort: {\n      $id{View Consultant Details.Consultant}: 1\n    }\n  }\n\n]","cacheRemoteDataInMongoSeconds":300,"typeClass":"com.xerini.xefr.model.XefrMongoViewSchema"},{"id":"5c816928-8fa7-4361-9f62-86973a12608a","name":"View Distinct Contractor Count UK","description":"","attributes":[{"id":"6afd6057-a607-41b2-a7d8-30dca46fdb17","name":"Year","type":"STRING"},{"id":"27e3da46-ce03-4da1-a413-c577bc222bfb","name":"Month","type":"STRING"},{"id":"56811c55-3aac-4b84-a8e1-5ad668272410","name":"Count","type":"NUMBER"}],"pipelineText":"[\n  {\n   $match: {\n    schemaId: $id{TSP UK Invoice Tracker}\n   }\n  },\n  {\n   $project: {\n    candidate: $$id{TSP UK Invoice Tracker.Candidate},\n    invoiceDate: $$id{TSP UK Invoice Tracker.InvoiceDate},\n    chargeCode: $$id{TSP UK Invoice Tracker.ChargeCode},\n   }\n  },\n  {\n   $unionWith: {\n    coll: \"dataInstances\",\n    pipeline: [\n     {\n      $match: {\n       schemaId: $id{TSP UK Contractor Invoices Tracker}\n      }\n     },\n     {\n      $project: {\n       candidate: $$id{TSP UK Contractor Invoices Tracker.Candidate},\n       invoiceDate: $$id{TSP UK Contractor Invoices Tracker.InvoiceDate},\n       chargeCode: $$id{TSP UK Contractor Invoices Tracker.ChargeCode},\n      }\n     }\n    ]\n   }\n  },\n  {\n   $unionWith: {\n    coll: \"dataInstances\",\n    pipeline: [\n     {\n      $match: {\n       schemaId: $id{Adjustments UK NFI}\n      }\n     },\n     {\n      $project: {\n       candidate: $$id{Adjustments UK NFI.Candidate},\n       invoiceDate: $$id{Adjustments UK NFI.InvoiceDate},\n       chargeCode: $$id{Adjustments UK NFI.ChargeCode},\n      }\n     }\n    ]\n   }\n  },\n  {\n   $set: {\n    year: { $dateToString: { format: \"%Y\", date: { $toDate: \"$invoiceDate\" } } },\n    month: { $concat: [{ $dateToString: { format: \"%m\", date: { $toDate: \"$invoiceDate\" } } }, \"-\", { $arrayElemAt: [[\"\", \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"], { $month: { $toDate: \"$invoiceDate\" } }] }] },\n   }\n  },\n    /* Union with UK Placements Forecast */\n  {   \n      $unionWith: {\n          coll: \"dataInstances\",\n          pipeline: [\n              {\n                  $match: {\n                  schemaId: $id{TSP UK Placements Forecast}\n                  }\n              }\n              ,\n              {\n                  $project: {\n                      candidate: $$id{TSP UK Placements Forecast.Candidate},\n                      chargeCode: \"Temp\",\n                      invoiceDate: $$id{TSP UK Placements Forecast.Forecast Date},\n                  }\n              }\n              ,\n              /* Common Calendar Columns */\n              {\n               $set: {\n                year: { $dateToString: { format: \"%Y\", date: { $toDate: \"$invoiceDate\" } } },\n                month: { $concat: [{ $dateToString: { format: \"%m\", date: { $toDate: \"$invoiceDate\" } } }, \"-\", { $arrayElemAt: [[\"\", \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"], { $month: { $toDate: \"$invoiceDate\" } }] }] },\n               }\n              }]\n              }\n\n  },\n  /* END Union with UK Placements Forecast */\n\n  /* ChargeCode Look Up */\n  {\n   $lookup: {\n    from: \"dataInstances\",\n    localField: \"chargeCode\",\n    foreignField: $id{Metrics Charge Codes.ChargeCode},\n    as: \"types\"\n   }\n  },\n  {\n   $set: {\n    \"firstType\": { $arrayElemAt: [\"$types\", 0] }\n   }\n  },\n  {\n   $set: {\n    type: \"$firstType._id{Metrics Charge Codes.Type}\"\n   }\n  },\n  {\n   $unset: [\"types\", \"firstType\"]\n  },\n  /* END */\n  {\n    $match:{\n      type: \"Contract\"\n    }\n  },\n  {\n      $group: {\n        _id: {\n          year: \"$year\",\n          month: \"$month\"\n        },\n        candidates: { $addToSet: \"$candidate\" }\n      }\n    },\n    {\n      $project: {\n        id: \"1\",\n        schemaId: $id{View Distinct Contractor Count UK},\n        $id{View Distinct Contractor Count UK.Year}: \"$_id.year\",\n        $id{View Distinct Contractor Count UK.Month}: \"$_id.month\",\n        $id{View Distinct Contractor Count UK.Count}: {$size: \"$candidates\"},\n      }\n    }\n]","typeClass":"com.xerini.xefr.model.XefrMongoViewSchema"},{"id":"5d3611e7-66ae-4505-85e2-cbaff96a54cd","name":"View Distinct Contractor Count US","description":"","attributes":[{"id":"ccd16523-7b6e-42f6-92e2-e254c4697c71","name":"Year","type":"STRING"},{"id":"6e5da60b-e1fc-4b30-9917-f1758db69c2d","name":"Month","type":"STRING"},{"id":"adc27e1f-020e-4729-bcaa-b34755cd9e48","name":"Count","type":"NUMBER"}],"pipelineText":"[\n  {\n   $match: {\n    schemaId: $id{TSP US Invoice Tracker}\n   }\n  },\n  {\n   $project: {\n    candidate: $$id{TSP US Invoice Tracker.Candidate},\n    invoiceDate: $$id{TSP US Invoice Tracker.InvoiceDate},\n    chargeCode: $$id{TSP US Invoice Tracker.ChargeCode},\n   }\n  },\n  {\n   $unionWith: {\n    coll: \"dataInstances\",\n    pipeline: [\n     {\n      $match: {\n       schemaId: $id{TSP US Contractor Invoices Tracker}\n      }\n     },\n     {\n      $project: {\n       candidate: $$id{TSP US Contractor Invoices Tracker.Candidate},\n       invoiceDate: $$id{TSP US Contractor Invoices Tracker.InvoiceDate},\n       chargeCode: $$id{TSP US Contractor Invoices Tracker.ChargeCode},\n      }\n     }\n    ]\n   }\n  },\n  {\n   $unionWith: {\n    coll: \"dataInstances\",\n    pipeline: [\n     {\n      $match: {\n       schemaId: $id{Adjustments US NFI}\n      }\n     },\n     {\n      $project: {\n       candidate: $$id{Adjustments US NFI.Candidate},\n       invoiceDate: $$id{Adjustments US NFI.InvoiceDate},\n       chargeCode: $$id{Adjustments US NFI.ChargeCode},\n      }\n     }\n    ]\n   }\n  },\n  {\n   $set: {\n    year: { $dateToString: { format: \"%Y\", date: { $toDate: \"$invoiceDate\" } } },\n    month: { $concat: [{ $dateToString: { format: \"%m\", date: { $toDate: \"$invoiceDate\" } } }, \"-\", { $arrayElemAt: [[\"\", \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"], { $month: { $toDate: \"$invoiceDate\" } }] }] },\n   }\n  },\n    /* Union with US Placements Forecast */\n  {   \n      $unionWith: {\n          coll: \"dataInstances\",\n          pipeline: [\n              {\n                  $match: {\n                  schemaId: $id{TSP US Placements Forecast}\n                  }\n              }\n              ,\n              {\n                  $project: {\n                      candidate: $$id{TSP US Placements Forecast.Candidate},\n                      chargeCode: \"Temp\",\n                      invoiceDate: $$id{TSP US Placements Forecast.Forecast Date},\n                  }\n              }\n              ,\n              /* Common Calendar Columns */\n              {\n               $set: {\n                year: { $dateToString: { format: \"%Y\", date: { $toDate: \"$invoiceDate\" } } },\n                month: { $concat: [{ $dateToString: { format: \"%m\", date: { $toDate: \"$invoiceDate\" } } }, \"-\", { $arrayElemAt: [[\"\", \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"], { $month: { $toDate: \"$invoiceDate\" } }] }] },\n               }\n              }]\n              }\n\n  },\n  /* END Union with US Placements Forecast */\n\n  /* ChargeCode Look Up */\n  {\n   $lookup: {\n    from: \"dataInstances\",\n    localField: \"chargeCode\",\n    foreignField: $id{Metrics Charge Codes.ChargeCode},\n    as: \"types\"\n   }\n  },\n  {\n   $set: {\n    \"firstType\": { $arrayElemAt: [\"$types\", 0] }\n   }\n  },\n  {\n   $set: {\n    type: \"$firstType._id{Metrics Charge Codes.Type}\"\n   }\n  },\n  {\n   $unset: [\"types\", \"firstType\"]\n  },\n  /* END */\n  {\n    $match:{\n      type: \"Contract\"\n    }\n  },\n  {\n      $group: {\n        _id: {\n          year: \"$year\",\n          month: \"$month\"\n        },\n        candidates: { $addToSet: \"$candidate\" }\n      }\n    },\n    {\n      $project: {\n        id: \"1\",\n        schemaId: $id{View Distinct Contractor Count US},\n        $id{View Distinct Contractor Count US.Year}: \"$_id.year\",\n        $id{View Distinct Contractor Count US.Month}: \"$_id.month\",\n        $id{View Distinct Contractor Count US.Count}: {$size: \"$candidates\"},\n      }\n    }\n]","typeClass":"com.xerini.xefr.model.XefrMongoViewSchema"},{"id":"6480eb37-35a5-45ce-b9d5-04ed7d6ebc12","name":"View FOREX GBP Count","description":"A count of the entries per day for a given year, month, day, symbol. Used to spot days with \u003e1 rate defined on them.","attributes":[{"id":"3c1f1bee-f086-4405-ac98-06657bd52d37","name":"Year","type":"STRING"},{"id":"445b75f7-4f60-4198-9b2d-a58e546e420c","name":"Month","type":"STRING"},{"id":"6da5e4c3-f6a9-463a-9363-a53b2f494aa5","name":"Day","type":"NUMBER"},{"id":"59d6d368-7440-4804-8af6-6dff3b5126ff","name":"Symbol","type":"STRING"},{"id":"2918d95b-93cf-4ddb-9840-6b27ece97f6b","name":"Count","type":"NUMBER"}],"pipelineText":"[\n  {\n    $match:\n      {\n        schemaId:\n          $id{FOREX GBP}\n      }\n  },\n  {\n    $group:\n      {\n        _id: {\n          year: $$id{FOREX GBP.Year},\n          month: $$id{FOREX GBP.Month},\n          day: $$id{FOREX GBP.Day},\n          symbol: $$id{FOREX GBP.Symbol}\n        },\n        count: {\n          $count: {}\n        }\n      }\n  },\n  {\n    $match:{\n      count: { $gt: 1 }\n    }\n  }\n  ,\n  {\n    $project:\n      {\n        id: \"1\",\n        schemaId: $id{View FOREX GBP Count},\n        $id{View FOREX GBP Count.Year}: \"$_id.year\",\n        $id{View FOREX GBP Count.Month}: \"$_id.month\",\n        $id{View FOREX GBP Count.Day}: { $toInt: \"$_id.day\"},\n        $id{View FOREX GBP Count.Symbol}: \"$_id.symbol\",\n        $id{View FOREX GBP Count.Count}: \"$count\"\n      }\n  }\n]","typeClass":"com.xerini.xefr.model.XefrMongoViewSchema"},{"id":"571579bb-c83f-4a17-b63b-be36693b99f5","name":"View FOREX GBP Forecast","description":"The currencies that are used for GBP forecasts","attributes":[{"id":"c4fa3a4d-b2d2-449f-b988-d2a5de41819b","name":"Symbol","type":"STRING"},{"id":"0aed765f-b69c-4d0d-b4ad-44f15029e581","name":"GBP Rate","type":"NUMBER"},{"id":"d4c00829-8862-457c-b605-673ecd3327fb","name":"Year","type":"STRING"},{"id":"266a682d-8ab0-490d-bf60-20092bd4341d","name":"Month","type":"STRING"},{"id":"65f4b660-b005-4d31-9a12-c1358cc3b2cf","name":"Day","type":"NUMBER"}],"pipelineText":"[\n  {\n    $match:\n      {\n        schemaId: $id{FOREX GBP}\n      }\n  }\n  ,\n  /* Create a yyyymmdd variable to sort by */\n  {\n    $set:{\n      month_portion: {$substr: [$$id{FOREX GBP.Month}, 0, 2 ]}\n    }\n  }\n  ,\n  {\n    $set:{\n      day_portion:  { $arrayElemAt: [{ $split: [{ $toString: $$id{FOREX GBP.Day} }, \".\"] }, 0] }\n    }\n  }\n  ,\n  {\n    $set:{\n      day_padded: {$cond: {\n                            if: { $gte: [{ $strLenCP: \"$day_portion\"}, 2] },\n                            then: \"$day_portion\",\n                            else: { $concat: [\"0\", \"$day_portion\"] }\n                        }}\n    }\n  }\n  ,\n  {\n    $set:{\n      yyyymmdd: {  $concat: [ $$id{FOREX GBP.Year}, \"$month_portion\", \"$day_padded\"]  }\n    }\n  }\n  /* END */\n  ,\n  {\n    $sort:\n      {\n        \"yyyymmdd\": -1\n      }\n  },\n  {\n    $group:\n      {\n        _id: $$id{FOREX GBP.Symbol}\n        , \n        rate: {\n          $first: $$id{FOREX GBP.GBP Rate}\n        }\n        ,\n        year: {\n          $first: $$id{FOREX GBP.Year}\n        }\n        ,\n        month: {\n          $first: $$id{FOREX GBP.Month}\n        }\n        ,\n        day: {\n          $first: $$id{FOREX GBP.Day}\n        }\n      }\n  }\n  ,\n  {\n      $project: {\n          id: \"1\",\n          schemaId: $id{View FOREX GBP Forecast},\n          $id{View FOREX GBP Forecast.Symbol}: \"$_id\",\n          $id{View FOREX GBP Forecast.GBP Rate}: \"$rate\",\n          $id{View FOREX GBP Forecast.Month}: \"$month\",\n          $id{View FOREX GBP Forecast.Day}: \"$day\",\n          $id{View FOREX GBP Forecast.Year}: \"$year\"\n          \n      }\n  }\n  ,\n  {\n    $unset: [\"month_portion\",\"day_portion\",\"day_padded\",\"yyyymmdd\"]\n  }\n]","typeClass":"com.xerini.xefr.model.XefrMongoViewSchema"},{"id":"c9d30873-5b98-410d-9d33-701da2fa4fb8","name":"View FOREX GBP Missing","description":"GBP FX rates missing for any invoice date present in TSP UK Invoice Tracker or TSP UK Contractor Invoices Tracker.","attributes":[{"id":"6ee8bea5-0d0f-4ea6-8f1f-7479f5947fae","name":"Year","type":"STRING"},{"id":"e74c317e-0f27-4641-a98e-9ddee18bca8b","name":"Month","type":"STRING"},{"id":"e6bcd47e-95d4-4184-874b-377d913f0b7b","name":"Day","type":"NUMBER"},{"id":"dddf8723-e218-4a82-959a-ed2ba0d3841e","name":"Symbol","type":"STRING"},{"id":"29e55a86-ad78-40db-ac42-d7addfc7a0e0","name":"InvoiceDate","type":"DATE"}],"pipelineText":"[\n  \n  { \n    $match: {\n      $and:[\n      {schemaId: $id{TSP UK Invoice Tracker}},\n      {$id{TSP UK Invoice Tracker.Currency}: {$ne: \"£\"}}\n      ]\n      \n    }\n  },\n  {\n    $group: {\n      _id: {\n        invoicedate: $$id{TSP UK Invoice Tracker.InvoiceDate},\n        symbol: $$id{TSP UK Invoice Tracker.Currency}\n      }\n    }\n  },\n  {\n    $project: {\n      id: \"1\",\n      schemaId: $id{View FOREX GBP Missing},\n      $id{View FOREX GBP Missing.InvoiceDate}: \"$_id.invoicedate\",\n      $id{View FOREX GBP Missing.Symbol}: \"$_id.symbol\"\n    }\n  }\n  ,\n  {\n     $unionWith: {\n      coll: \"dataInstances\",\n      pipeline: [\n                { \n          $match: {\n            $and:[\n            {schemaId: $id{TSP UK Contractor Invoices Tracker}},\n            {$id{TSP UK Contractor Invoices Tracker.Currency}: {$ne: \"£\"}}\n            ]\n          }\n        },\n        {\n          $group: {\n            _id: {\n              invoicedate: $$id{TSP UK Contractor Invoices Tracker.InvoiceDate},\n              symbol: $$id{TSP UK Contractor Invoices Tracker.Currency}\n            }\n          }\n        },\n        {\n          $project: {\n            id: \"1\",\n            schemaId: $id{View FOREX GBP Missing},\n            $id{View FOREX GBP Missing.InvoiceDate}: \"$_id.invoicedate\",\n            $id{View FOREX GBP Missing.Symbol}: \"$_id.symbol\"\n          }\n        }\n      ]\n    }\n  }\n  ,\n  \n{\n  $set:{\n    $id{View FOREX GBP Missing.Year}: { $dateToString: { format: \"%Y\", date: { $toDate: $$id{View FOREX GBP Missing.InvoiceDate} } } },\n    $id{View FOREX GBP Missing.Month}: { $concat: [{ $dateToString: { format: \"%m\", date: { $toDate: $$id{View FOREX GBP Missing.InvoiceDate} } } }, \"-\", { $arrayElemAt: [[\"\", \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"], { $month: { $toDate: $$id{View FOREX GBP Missing.InvoiceDate}} }] }] },\n    $id{View FOREX GBP Missing.Day}: { $dayOfMonth: { $toDate: $$id{View FOREX GBP Missing.InvoiceDate} } }\n  }\n},\n{\n $set: {\n  fxLookup: {\n   $concat: [\n    { $toString: $$id{View FOREX GBP Missing.Year} },\n    { $toString: $$id{View FOREX GBP Missing.Month} },\n    { $toString: $$id{View FOREX GBP Missing.Day} },\n    { $toString: $$id{View FOREX GBP Missing.Symbol} }\n   ]\n  }\n }\n},\n{\n $lookup: {\n  from: \"dataInstances\",\n  localField: \"fxLookup\",\n  foreignField: \"compoundIndexValues._id{FOREX GBP}.gbpFXLookup\",\n  as: \"exchangeRates\"\n }\n},\n{\n $match: {\n  \"exchangeRates\": { $size: 0 }\n }\n},\n{\n $set: {\n  \"id\": 1,\n  \"schemaId\": $id{View FOREX GBP Missing}\n }\n},\n{\n  $sort:{\n    $id{View FOREX GBP Missing.Year}: 1,\n    $id{View FOREX GBP Missing.Month}: 1,\n    $id{View FOREX GBP Missing.Day}: 1,\n    $id{View FOREX GBP Missing.Symbol}: 1\n  }\n}\n]","typeClass":"com.xerini.xefr.model.XefrMongoViewSchema"},{"id":"76696c9e-0f3f-4460-896f-a9f0c17762ce","name":"View FOREX USD Count","description":"A count of the entries per day for a given year, month, day, symbol. Used to spot days with \u003e1 rate defined on them.","attributes":[{"id":"3c1f1bee-f086-4405-ac98-06657bd52d37","name":"Year","type":"STRING"},{"id":"445b75f7-4f60-4198-9b2d-a58e546e420c","name":"Month","type":"STRING"},{"id":"6da5e4c3-f6a9-463a-9363-a53b2f494aa5","name":"Day","type":"NUMBER"},{"id":"59d6d368-7440-4804-8af6-6dff3b5126ff","name":"Symbol","type":"STRING"},{"id":"2918d95b-93cf-4ddb-9840-6b27ece97f6b","name":"Count","type":"NUMBER"}],"pipelineText":"[\n  {\n    $match:\n      {\n        schemaId:\n          $id{FOREX USD}\n      }\n  },\n  {\n    $group:\n      {\n        _id: {\n          year: $$id{FOREX USD.Year},\n          month: $$id{FOREX USD.Month},\n          day: $$id{FOREX USD.Day},\n          symbol: $$id{FOREX USD.Symbol}\n        },\n        count: {\n          $count: {}\n        }\n      }\n  },\n  {\n    $match:{\n      count: { $gt: 1 }\n    }\n  }\n  ,\n  {\n    $project:\n      {\n        id: \"1\",\n        schemaId: $id{View FOREX USD Count},\n        $id{View FOREX USD Count.Year}: \"$_id.year\",\n        $id{View FOREX USD Count.Month}: \"$_id.month\",\n        $id{View FOREX USD Count.Day}: { $toInt: \"$_id.day\"},\n        $id{View FOREX USD Count.Symbol}: \"$_id.symbol\",\n        $id{View FOREX USD Count.Count}: \"$count\"\n      }\n  }\n]","typeClass":"com.xerini.xefr.model.XefrMongoViewSchema"},{"id":"f9b3f845-2aea-4520-9ae1-620451483a65","name":"View FOREX USD Forecast","description":"Currencies rates that are used for USD Forecasts","attributes":[{"id":"69d0a388-b91c-4ad1-b1ef-ff75b754fed4","name":"Symbol","type":"STRING"},{"id":"700dddb1-2ea1-4545-ac93-039b03a94448","name":"USD Rate","type":"NUMBER"},{"id":"b472cb22-5ef5-4a83-9f2d-f2ebc98d66cb","name":"Year","type":"STRING"},{"id":"d0d22de2-adc6-4f3b-a940-f4c4a7ae5265","name":"Month","type":"STRING"},{"id":"c78d3509-95e4-4506-b526-47db3eb5cbfe","name":"Day","type":"STRING"}],"pipelineText":"[\n  {\n    $match:\n      {\n        schemaId: $id{FOREX USD}\n      }\n  }\n  ,\n  /* Create a yyyymmdd variable to sort by */\n  {\n    $set:{\n      month_portion: {$substr: [$$id{FOREX USD.Month}, 0, 2 ]}\n    }\n  }\n  ,\n  {\n    $set:{\n      day_portion:  { $arrayElemAt: [{ $split: [{ $toString: $$id{FOREX USD.Day} }, \".\"] }, 0] }\n    }\n  }\n  ,\n  {\n    $set:{\n      day_padded: {$cond: {\n                            if: { $gte: [{ $strLenCP: \"$day_portion\"}, 2] },\n                            then: \"$day_portion\",\n                            else: { $concat: [\"0\", \"$day_portion\"] }\n                        }}\n    }\n  }\n  ,\n  {\n    $set:{\n      yyyymmdd: {  $concat: [ $$id{FOREX USD.Year}, \"$month_portion\", \"$day_padded\"]  }\n    }\n  }\n  /* END */\n  ,\n  {\n    $sort:\n      {\n        \"yyyymmdd\": -1\n      }\n  },\n  {\n    $group:\n      {\n        _id: $$id{FOREX USD.Symbol}\n        , \n        rate: {\n          $first: $$id{FOREX USD.USD Rate}\n        }\n        ,\n        year: {\n          $first: $$id{FOREX USD.Year}\n        }\n        ,\n        month: {\n          $first: $$id{FOREX USD.Month}\n        }\n        ,\n        day: {\n          $first: $$id{FOREX USD.Day}\n        }\n      }\n  }\n  ,\n  {\n      $project: {\n          id: \"1\",\n          schemaId: $id{View FOREX USD Forecast},\n          $id{View FOREX USD Forecast.Symbol}: \"$_id\",\n          $id{View FOREX USD Forecast.USD Rate}: \"$rate\",\n          $id{View FOREX USD Forecast.Month}: \"$month\",\n          $id{View FOREX USD Forecast.Day}: \"$day\",\n          $id{View FOREX USD Forecast.Year}: \"$year\"\n          \n      }\n  }\n  ,\n  {\n    $unset: [\"month_portion\",\"day_portion\",\"day_padded\",\"yyyymmdd\"]\n  }\n]","typeClass":"com.xerini.xefr.model.XefrMongoViewSchema"},{"id":"c2411502-744f-450a-82de-237446a9ac7f","name":"View FOREX USD Missing","description":"","attributes":[{"id":"4dda8505-fcdd-4618-91f5-9779c973cbc4","name":"Year","type":"STRING"},{"id":"bc6eff1f-eedc-4161-8c5b-4cfc17e08eed","name":"Month","type":"STRING"},{"id":"85fe03a3-13a7-4dce-9f92-aa7ab1173294","name":"Day","type":"NUMBER"},{"id":"e180352e-7d31-4278-b36f-f246c7408247","name":"Symbol","type":"STRING"},{"id":"fd1baa2f-5028-4803-ac69-7a0b269a31fa","name":"InvoiceDate","type":"DATE"}],"pipelineText":"[\n  \n  { \n    $match: {\n      $and:[\n      {schemaId: $id{TSP US Invoice Tracker}},\n      {$id{TSP US Invoice Tracker.Currency}: {$ne: \"USD\"}}\n      ]\n      \n    }\n  },\n  {\n    $group: {\n      _id: {\n        invoicedate: $$id{TSP US Invoice Tracker.InvoiceDate},\n        symbol: $$id{TSP US Invoice Tracker.Currency}\n      }\n    }\n  },\n  {\n    $project: {\n      id: \"1\",\n      schemaId: $id{View FOREX USD Missing},\n      $id{View FOREX USD Missing.InvoiceDate}: \"$_id.invoicedate\",\n      $id{View FOREX USD Missing.Symbol}: \"$_id.symbol\"\n    }\n  }\n  ,\n  {\n     $unionWith: {\n      coll: \"dataInstances\",\n      pipeline: [\n                { \n          $match: {\n            $and:[\n            {schemaId: $id{TSP US Contractor Invoices Tracker}},\n            {$id{TSP US Contractor Invoices Tracker.Currency}: {$ne: \"USD\"}}\n            ]\n          }\n        },\n        {\n          $group: {\n            _id: {\n              invoicedate: $$id{TSP US Contractor Invoices Tracker.InvoiceDate},\n              symbol: $$id{TSP US Contractor Invoices Tracker.Currency}\n            }\n          }\n        },\n        {\n          $project: {\n            id: \"1\",\n            schemaId: $id{View FOREX USD Missing},\n            $id{View FOREX USD Missing.InvoiceDate}: \"$_id.invoicedate\",\n            $id{View FOREX USD Missing.Symbol}: \"$_id.symbol\"\n          }\n        }\n      ]\n    }\n  }\n  ,\n  \n{\n  $set:{\n    $id{View FOREX USD Missing.Year}: { $dateToString: { format: \"%Y\", date: { $toDate: $$id{View FOREX USD Missing.InvoiceDate} } } },\n    $id{View FOREX USD Missing.Month}: { $concat: [{ $dateToString: { format: \"%m\", date: { $toDate: $$id{View FOREX USD Missing.InvoiceDate} } } }, \"-\", { $arrayElemAt: [[\"\", \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"], { $month: { $toDate: $$id{View FOREX USD Missing.InvoiceDate}} }] }] },\n    $id{View FOREX USD Missing.Day}: { $dayOfMonth: { $toDate: $$id{View FOREX USD Missing.InvoiceDate} } }\n  }\n},\n{\n $set: {\n  fxLookup: {\n   $concat: [\n    { $toString: $$id{View FOREX USD Missing.Year} },\n    { $toString: $$id{View FOREX USD Missing.Month} },\n    { $toString: $$id{View FOREX USD Missing.Day} },\n    { $toString: $$id{View FOREX USD Missing.Symbol} }\n   ]\n  }\n }\n},\n{\n $lookup: {\n  from: \"dataInstances\",\n  localField: \"fxLookup\",\n  foreignField: \"compoundIndexValues._id{FOREX USD}.USDFXLookup\",\n  as: \"exchangeRates\"\n }\n},\n{\n $match: {\n  \"exchangeRates\": { $size: 0 }\n }\n},\n{\n $set: {\n  \"id\": 1,\n  \"schemaId\": $id{View FOREX USD Missing}\n }\n},\n{\n  $sort:{\n    $id{View FOREX USD Missing.Year}: 1,\n    $id{View FOREX USD Missing.Month}: 1,\n    $id{View FOREX USD Missing.Day}: 1,\n    $id{View FOREX USD Missing.Symbol}: 1\n  }\n}\n]","typeClass":"com.xerini.xefr.model.XefrMongoViewSchema"},{"id":"a27ba0f9-ec70-4c8f-8b36-2a30b9358536","name":"View Intercompany","description":"","attributes":[{"id":"fdab421f-2b8a-45a7-b951-eaca5973578d","name":"Year","type":"STRING"},{"id":"2a9ee583-6aba-4466-a572-0732ed5bbf00","name":"Month","type":"STRING"},{"id":"0e3eb947-21d3-4cec-9d43-9df70a5cb9e8","name":"Direction","type":"STRING"},{"id":"7aabb14e-f586-467a-ab21-cf4be3aac1a7","name":"GBP Amount","type":"NUMBER"}],"pipelineText":"[\n  $pipeline{View UK NFI Forecast},\n  {\n    $match: {\n      $id{View UK NFI Forecast.Country}: \"US\"\n    }\n  },\n  {\n    $project: {\n      id: 1,\n      schemaId: $id{View Intercompany},\n      $id{View Intercompany.Year}: $$id{View UK NFI Forecast.Year},\n      $id{View Intercompany.Month}: $$id{View UK NFI Forecast.Month},\n      $id{View Intercompany.GBP Amount}: $$id{View UK NFI Forecast.GBPLinePrice},\n      $id{View Intercompany.Direction}: \"Revenue Transfer to USA\"\n    }\n  },\n  {\n    $unionWith: {\n      coll: \"dataInstances\",\n      pipeline: [\n        {\n          $match: {\n            schemaId: $id{Adjustments Interco}\n          }\n        },\n        {\n          $project: {\n            id: \"1\",\n            schemaId: $id{View Intercompany},\n            $id{View Intercompany.Year}: $$id{Adjustments Interco.Year},\n            $id{View Intercompany.Month}: $$id{Adjustments Interco.Month},\n            $id{View Intercompany.GBP Amount}: $$id{Adjustments Interco.GBP Amount},\n            $id{View Intercompany.Direction}: \"Revenue Transfer to USA\"\n          }\n        }\n      ]\n    }\n  },\n  {\n    $unionWith: {\n      coll: \"dataInstances\",\n      pipeline: [\n        $pipeline{View US NFI Forecast},\n        {\n          $project: {\n            id: 1,\n            schemaId: $id{View Intercompany},\n            $id{View Intercompany.Year}: $$id{View US NFI Forecast.Year},\n            $id{View Intercompany.Month}: $$id{View US NFI Forecast.Month},\n            $id{View Intercompany.GBP Amount}: $$id{View US NFI Forecast.GBPLinePrice},\n            $id{View Intercompany.Direction}: \"Revenue Transfer from USA\"\n          }\n        }\n      ]\n    }\n  }\n]","typeClass":"com.xerini.xefr.model.XefrMongoViewSchema"},{"id":"cd455ac5-1771-4846-bac3-dbf8f3cdbe67","name":"View UK NFI Forecast","description":"","attributes":[{"id":"b99221e8-66cc-487d-b511-ab517a22b74c","name":"Candidate","type":"STRING"},{"id":"4c7a6b5f-cc24-40dc-a636-1ec959481996","name":"CompanyName","type":"STRING"},{"id":"7c57cf94-57ef-4474-aff4-b36d31660fa9","name":"Placement","type":"STRING"},{"id":"efa4ac71-67d8-45be-8926-938ceb70670c","name":"InvoiceDate","type":"DATE"},{"id":"ccdd0914-d127-4621-be97-2b9c5f34620e","name":"Currency","type":"STRING"},{"id":"13a6cfb2-a43c-40e2-9c13-5bb589de6bca","name":"LinePrice","type":"NUMBER"},{"id":"8090e634-6045-4cc9-890e-5bbbf60d752d","name":"ChargeCode","type":"STRING"},{"id":"c9725ac8-8abf-49c3-a50c-3e39b58a8e5d","name":"Source","type":"STRING"},{"id":"6266bbfc-eee2-40a9-914d-bcd0626cf3ce","name":"Country","type":"STRING"},{"id":"9646b633-2625-47a1-98b2-2c836d2a86a4","name":"Year","type":"STRING"},{"id":"c78708c7-cec5-40bf-b1c2-28db30ed2a43","name":"Month","type":"STRING"},{"id":"cb7c3204-29ce-42ff-bd1e-b082cef289a4","name":"Day","type":"NUMBER"},{"id":"4703492c-7273-4f9f-892a-e3d1fefb2f81","name":"Quarter","type":"STRING"},{"id":"0e9589e1-0c58-4b5f-8801-a50a2f233e5e","name":"Multiplier","type":"NUMBER"},{"id":"8d18c82a-3486-48d6-9904-f04de004d504","name":"ExchangeRate","type":"NUMBER"},{"id":"e64778eb-6679-4863-a07b-401d6c728d3c","name":"Consultant","type":"STRING"},{"id":"28788c1c-4c42-4a5a-b851-f6125a901aef","name":"Type","type":"STRING"},{"id":"2b1f6cde-4490-450e-81d8-589c6076f875","name":"GBPLinePrice","type":"NUMBER"},{"id":"40da2d1a-0235-47eb-97b3-168328287d59","name":"Forecast Cut Off","type":"DATE"},{"id":"c4b504ab-63d1-4787-9e8f-443b10f7bc8a","name":"ChargeRate","type":"NUMBER"},{"id":"49fb0b6f-2a84-4a82-8fa8-957d461caaa8","name":"ChargeRateSymbol","type":"STRING"},{"id":"8c039dc2-778a-4bc6-9292-73e6f0185e6b","name":"ChargeRateExchange","type":"NUMBER"},{"id":"c27158cf-0061-466c-9368-2ec544feabb6","name":"Placement Start","type":"DATE"},{"id":"80699966-4183-450a-9b97-f106207eb1a8","name":"Placement End","type":"DATE"},{"id":"ec9b88be-6ee6-4343-8935-d9d65cbb5dec","name":"PayRateSymbol","type":"STRING"},{"id":"a27f342f-ed2b-4180-8c8d-cc9a5b448bb2","name":"PayRate","type":"STRING"},{"id":"5c753647-9d0b-440c-a2f7-473706f8c164","name":"PayRateExchange","type":"NUMBER"},{"id":"ba9110a3-f364-4183-bfde-f047439029f8","name":"Unit","type":"STRING"},{"id":"47560622-f958-4c4c-a912-1b989ff3c661","name":"ChargeRateGBP","type":"NUMBER"},{"id":"9671eea9-6c39-4d98-a8ca-138b0da2b3c9","name":"PayRateGBP","type":"NUMBER"},{"id":"495202e9-8033-433c-9301-fcf4c3a45374","name":"NetRevenueGBP","type":"NUMBER"},{"id":"3de99f20-6248-4552-afbc-669768948d09","name":"WorkingDays","type":"NUMBER"},{"id":"c4d2211a-855f-48f1-ab3a-4fa6a76747c6","name":"Team","type":"STRING"},{"id":"20ce7dcd-8f99-438a-a78b-6186bef3c682","name":"Team Lead","type":"STRING"}],"pipelineText":"[\n  {\n   $match: {\n    schemaId: $id{TSP UK Invoice Tracker}\n   }\n  },\n  {\n   $project: {\n    id: 1,\n    schemaId: $id{View UK NFI Forecast},\n    $id{View UK NFI Forecast.Candidate}: $$id{TSP UK Invoice Tracker.Candidate},\n    $id{View UK NFI Forecast.CompanyName}: $$id{TSP UK Invoice Tracker.CompanyName},\n    $id{View UK NFI Forecast.Placement}: { $toString: $$id{TSP UK Invoice Tracker.Placement} },\n    $id{View UK NFI Forecast.InvoiceDate}: $$id{TSP UK Invoice Tracker.InvoiceDate},\n    $id{View UK NFI Forecast.Currency}: $$id{TSP UK Invoice Tracker.Currency},\n    $id{View UK NFI Forecast.LinePrice}: $$id{TSP UK Invoice Tracker.LinePrice},\n    $id{View UK NFI Forecast.ChargeCode}: $$id{TSP UK Invoice Tracker.ChargeCode},\n    $id{View UK NFI Forecast.Source}: $$id{TSP UK Invoice Tracker.Source},\n    $id{View UK NFI Forecast.Country}: $$id{TSP UK Invoice Tracker.Country}\n   }\n  },\n  {\n   $unionWith: {\n    coll: \"dataInstances\",\n    pipeline: [\n     {\n      $match: {\n       schemaId: $id{TSP UK Contractor Invoices Tracker}\n      }\n     },\n     {\n      $project: {\n       id: 1,\n       schemaId: $id{View UK NFI Forecast},\n       $id{View UK NFI Forecast.Candidate}: $$id{TSP UK Contractor Invoices Tracker.Candidate},\n       $id{View UK NFI Forecast.CompanyName}: $$id{TSP UK Contractor Invoices Tracker.CompanyName},\n       $id{View UK NFI Forecast.Placement}: { $toString: $$id{TSP UK Contractor Invoices Tracker.Placement} },\n       $id{View UK NFI Forecast.InvoiceDate}: $$id{TSP UK Contractor Invoices Tracker.InvoiceDate},\n       $id{View UK NFI Forecast.Currency}: $$id{TSP UK Contractor Invoices Tracker.Currency},\n       $id{View UK NFI Forecast.LinePrice}: $$id{TSP UK Contractor Invoices Tracker.LinePrice},\n       $id{View UK NFI Forecast.ChargeCode}: $$id{TSP UK Contractor Invoices Tracker.ChargeCode},\n       $id{View UK NFI Forecast.Source}: $$id{TSP UK Contractor Invoices Tracker.Source},\n       $id{View UK NFI Forecast.Country}: $$id{TSP UK Contractor Invoices Tracker.Country}\n      }\n     }\n    ]\n   }\n  },\n  {\n   $unionWith: {\n    coll: \"dataInstances\",\n    pipeline: [\n     {\n      $match: {\n       schemaId: $id{Adjustments UK NFI}\n      }\n     },\n     {\n      $project: {\n       id: 1,\n       schemaId: $id{View UK NFI Forecast},\n       $id{View UK NFI Forecast.Candidate}: $$id{Adjustments UK NFI.Candidate},\n       $id{View UK NFI Forecast.CompanyName}: $$id{Adjustments UK NFI.CompanyName},\n       $id{View UK NFI Forecast.Placement}: { $toString: $$id{Adjustments UK NFI.Placement} },\n       $id{View UK NFI Forecast.InvoiceDate}: $$id{Adjustments UK NFI.InvoiceDate},\n       $id{View UK NFI Forecast.Currency}: $$id{Adjustments UK NFI.Currency},\n       $id{View UK NFI Forecast.LinePrice}: $$id{Adjustments UK NFI.LinePrice},\n       $id{View UK NFI Forecast.ChargeCode}: $$id{Adjustments UK NFI.ChargeCode},\n       $id{View UK NFI Forecast.Source}: $$id{Adjustments UK NFI.Source}\n      }\n     }\n    ]\n   }\n  },\n  {\n   $set: {\n    $id{View UK NFI Forecast.Year}: { $dateToString: { format: \"%Y\", date: { $toDate: $$id{View UK NFI Forecast.InvoiceDate} } } },\n    $id{View UK NFI Forecast.Month}: { $concat: [{ $dateToString: { format: \"%m\", date: { $toDate: $$id{View UK NFI Forecast.InvoiceDate} } } }, \"-\", { $arrayElemAt: [[\"\", \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"], { $month: { $toDate: $$id{View UK NFI Forecast.InvoiceDate} } }] }] },\n    $id{View UK NFI Forecast.Day}: { $dayOfMonth: { $toDate: $$id{View UK NFI Forecast.InvoiceDate} } },\n    $id{View UK NFI Forecast.Quarter}: { $concat: [\"Q\", { $arrayElemAt: [[\"\", \"1\", \"1\", \"1\", \"2\", \"2\", \"2\", \"3\", \"3\", \"3\", \"4\", \"4\", \"4\"], { $month: { $toDate: $$id{View UK NFI Forecast.InvoiceDate} } }] }] },\n    $id{View UK NFI Forecast.Multiplier}: { $cond: { if: { $eq: [$$id{View UK NFI Forecast.Source}, \"TSP UK Contractor Invoices\"] }, then: -1, else: 1 } }\n   }\n  },\n  {\n   $set: {\n    fxLookup: {\n     $concat: [\n      { $toString: $$id{View UK NFI Forecast.Year} },\n      { $toString: $$id{View UK NFI Forecast.Month} },\n      { $toString: $$id{View UK NFI Forecast.Day} },\n      { $toString: $$id{View UK NFI Forecast.Currency} }\n     ]\n    }\n   }\n  },\n  {\n   $lookup: {\n    from: \"dataInstances\",\n    localField: \"fxLookup\",\n    foreignField: \"compoundIndexValues._id{FOREX GBP}.gbpFXLookup\",\n    as: \"exchangeRates\"\n   }\n  },\n  {\n   $set: {\n    \"firstRate\": { $arrayElemAt: [\"$exchangeRates\", 0] }\n   }\n  },\n  {\n   $set: {\n    $id{View UK NFI Forecast.ExchangeRate}: { $cond: [ { $eq: [$$id{View UK NFI Forecast.Currency}, \"£\"] } , 1, \"$firstRate._id{FOREX GBP.GBP Rate}\" ] }\n   }\n  },\n  {\n   $unset: [\"exchangeRates\", \"firstRate\", \"fxLookup\"]\n  }\n  ,\n  {\n   $set: {\n    $id{View UK NFI Forecast.GBPLinePrice}: {\n     $cond: {\n      if: { $gt: [$$id{View UK NFI Forecast.ExchangeRate}, 1] },\n      then: { $multiply: [ $$id{View UK NFI Forecast.Multiplier}, { $divide: [$$id{View UK NFI Forecast.LinePrice}, $$id{View UK NFI Forecast.ExchangeRate}] } ]},\n      else: { $multiply: [ $$id{View UK NFI Forecast.Multiplier}, { $multiply: [$$id{View UK NFI Forecast.LinePrice}, $$id{View UK NFI Forecast.ExchangeRate}] } ]}\n     }\n    }\n   }\n  }\n  ,\n  /* Bring in the Forecast date */\n  {\n    $lookup: {\n      from: \"dataInstances\",\n      pipeline: [\n          {\n              $match: {\n              schemaId: $id{FOREX Forecast Date}\n              }\n          }\n          ,\n          {\n              $project: {\n              ForecastDate: $$id{FOREX Forecast Date.Forecast Date From}\n              }\n          }\n          ,\n          {\n              $sort: {\n              ForecastDate: -1\n              }\n          }\n          ,\n          {\n              $limit: 1\n          }  \n      ]\n      ,\n      as: \"forecast_date\"\n    }\n  }\n  ,\n  {\n      $set: { \n          \"firstForecastDate\" : { $arrayElemAt: [\"$forecast_date\",0]} \n      }\n  }\n  ,\n  {\n    $set: {\n      $id{View UK NFI Forecast.Forecast Cut Off}:\"$firstForecastDate.ForecastDate\"\n    }\n  }\n  /* END */\n  ,\n  /* Union with UK Placements Forecast */\n  {   \n      $unionWith: {\n          coll: \"dataInstances\",\n          pipeline: [\n              {\n                  $match: {\n                  schemaId: $id{TSP UK Placements Forecast}\n                  }\n              }\n              ,\n              {\n                  $project: {\n                      id: 1,\n                      schemaId: $id{View UK NFI Forecast},\n                      $id{View UK NFI Forecast.Candidate}: $$id{TSP UK Placements Forecast.Candidate},\n                      $id{View UK NFI Forecast.ChargeCode}: \"Temp\",\n                      $id{View UK NFI Forecast.CompanyName}: $$id{TSP UK Placements Forecast.CompanyName},\n                      $id{View UK NFI Forecast.Country}: \"UK\",\n                      $id{View UK NFI Forecast.Placement}: { $toString: $$id{TSP UK Placements Forecast.Placement} },\n                      $id{View UK NFI Forecast.InvoiceDate}: $$id{TSP UK Placements Forecast.Forecast Date},\n                      $id{View UK NFI Forecast.Currency}: \"n/a\",\n                      $id{View UK NFI Forecast.LinePrice}: \"0\",\n                      $id{View UK NFI Forecast.ChargeRate}: $$id{TSP UK Placements Forecast.Charge Rate},\n                      $id{View UK NFI Forecast.ChargeRateSymbol}: $$id{TSP UK Placements Forecast.CC Symbol},\n                      $id{View UK NFI Forecast.Source}: \"UK Placements Forecast\",      \n                      $id{View UK NFI Forecast.Placement Start}: $$id{TSP UK Placements Forecast.Placement Start},\n                      $id{View UK NFI Forecast.Placement End}: $$id{TSP UK Placements Forecast.Placement End},\n                      $id{View UK NFI Forecast.PayRateSymbol}: $$id{TSP UK Placements Forecast.PC Symbol},\n                      $id{View UK NFI Forecast.PayRate}: $$id{TSP UK Placements Forecast.Pay Rate},\n                      $id{View UK NFI Forecast.Unit}: $$id{TSP UK Placements Forecast.Unit}\n                  }\n              }\n              ,\n              /* Common Calendar Columns */\n              {\n               $set: {\n                $id{View UK NFI Forecast.Year}: { $dateToString: { format: \"%Y\", date: { $toDate: $$id{View UK NFI Forecast.InvoiceDate} } } },\n                $id{View UK NFI Forecast.Month}: { $concat: [{ $dateToString: { format: \"%m\", date: { $toDate: $$id{View UK NFI Forecast.InvoiceDate} } } }, \"-\", { $arrayElemAt: [[\"\", \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"], { $month: { $toDate: $$id{View UK NFI Forecast.InvoiceDate} } }] }] },\n                $id{View UK NFI Forecast.Day}: { $dayOfMonth: { $toDate: $$id{View UK NFI Forecast.InvoiceDate} } },\n                $id{View UK NFI Forecast.Quarter}: { $concat: [\"Q\", { $arrayElemAt: [[\"\", \"1\", \"1\", \"1\", \"2\", \"2\", \"2\", \"3\", \"3\", \"3\", \"4\", \"4\", \"4\"], { $month: { $toDate: $$id{View UK NFI Forecast.InvoiceDate} } }] }] },\n                $id{View UK NFI Forecast.Multiplier}: { $cond: { if: { $eq: [$$id{View UK NFI Forecast.Source}, \"TSP UK Contractor Invoices\"] }, then: -1, else: 1 } }\n               }\n              }\n              ,\n              /* Bring in Forecast Cut Off Date */\n              {\n                $lookup: {\n                  from: \"dataInstances\",\n                  pipeline: [\n                      {\n                        $match: {\n                          schemaId: $id{FOREX Forecast Date}\n                        }\n                      }\n                      ,\n                      {\n                        $project: {\n                          ForecastDate: $$id{FOREX Forecast Date.Forecast Date From}\n                        }\n                      }\n                      ,\n                      {\n                        $sort: {\n                          ForecastDate: -1\n                        }\n                      }\n                      ,\n                      {\n                        $limit: 1\n                      }  \n                  ]\n                  ,\n                  as: \"forecast_date\"\n                }\n              }\n              ,\n              {\n                  $set: { \n                      \"firstForecastDate\" : { $arrayElemAt: [\"$forecast_date\",0]} \n                  }\n              }\n              ,\n              {\n                $set: {\n                  $id{View UK NFI Forecast.Forecast Cut Off}:\"$firstForecastDate.ForecastDate\"\n                }\n              }\n              ,\n              /* END */\n              /* Charge Rate FX lookup */\n              {\n                  $lookup: {\n                      from: \"dataInstances\",\n                      localField: $id{View UK NFI Forecast.ChargeRateSymbol},\n                      foreignField: $id{FOREX GBP.Symbol},\n                      pipeline: [\n                        {\n                          $sort: {\n                            $id{FOREX GBP.Year}: -1, $id{FOREX GBP.Month}: -1, $id{FOREX GBP.Day}: -1\n                          }\n                        },\n                        {\n                          $limit: 1\n                        },\n                        {\n                          $project:{\n                            yyyymmdd: { \n                              $concat: [ $$id{FOREX GBP.Year}, {$substr: [$$id{FOREX GBP.Month}, 0, 2 ]}, {$cond: {\n                                        if: { $gte: [{ $strLenCP: { $arrayElemAt: [{ $split: [{ $toString: $$id{FOREX GBP.Day} }, \".\"] }, 0] }}, 2] },\n                                        then: { $arrayElemAt: [{ $split: [{ $toString: $$id{FOREX GBP.Day} }, \".\"] }, 0] },\n                                        else: { $concat: [\"0\", { $arrayElemAt: [{ $split: [{ $toString: $$id{FOREX GBP.Day} }, \".\"] }, 0] }] }\n                                    }}]  \n                            },\n                            $id{FOREX GBP.GBP Rate}:1\n                          }\n                        }\n                      ],\n                      as: \"ForecastChargeExchangeRates\"\n                  }\n              }\n              ,\n              {\n                  $set: { \n                      \"firstChargeExchangeRates\" : { $arrayElemAt: [\"$ForecastChargeExchangeRates\",0]} \n                  }\n              },\n              {\n                $unset: \"ForecastChargeExchangeRates\"\n              }\n              ,\n              {\n                  $set:{\n                          $id{View UK NFI Forecast.ChargeRateExchange}: { \n                          $cond: [ { $eq: [$$id{View UK NFI Forecast.ChargeRateSymbol}, \"£\"] } , 1, \"$firstChargeExchangeRates._id{FOREX GBP.GBP Rate}\" ]\n                      }\n                  }\n              }\n              ,\n              {\n                  $unset: [ \"firstChargeExchangeRates\"]\n              }\n              ,\n              {\n                  $set: {\n                      $id{View UK NFI Forecast.ChargeRateGBP}: {\n                          $cond: {\n                              if: { $gt: [$$id{View UK NFI Forecast.ChargeRateExchange}, 1] },\n                              then: { $divide: [$$id{View UK NFI Forecast.ChargeRate},$$id{View UK NFI Forecast.ChargeRateExchange}] },\n                              else: { $multiply: [$$id{View UK NFI Forecast.ChargeRate},$$id{View UK NFI Forecast.ChargeRateExchange}]}\n                          }\n                      }\n                  }\n              }\n              ,\n              {\n                  $set:{\n                      $id{View UK NFI Forecast.ChargeRateGBP}: {\n                          $round: [{$toDouble:$$id{View UK NFI Forecast.ChargeRateGBP}},2]\n                          \n                      }\n                  }\n              }\n              /* END */\n              ,\n              /* Pay Rate FX Lookup */\n              {\n                  $lookup: {\n                      from: \"dataInstances\",\n                      localField: $id{View UK NFI Forecast.PayRateSymbol},\n                      foreignField: $id{FOREX GBP.Symbol},\n                      pipeline: [\n                         {\n                          $sort: {\n                            $id{FOREX GBP.Year}: -1, $id{FOREX GBP.Month}: -1, $id{FOREX GBP.Day}: -1\n                          }\n                        },\n                        {\n                          $limit: 1\n                        },\n\n                        {\n                          $project:{\n\n                          yyyymmdd: { \n                            \n                          $concat: [ $$id{FOREX GBP.Year}, {$substr: [$$id{FOREX GBP.Month}, 0, 2 ]}, {$cond: {\n                            if: { $gte: [{ $strLenCP: { $arrayElemAt: [{ $split: [{ $toString: $$id{FOREX GBP.Day} }, \".\"] }, 0] }}, 2] },\n                            then: { $arrayElemAt: [{ $split: [{ $toString: $$id{FOREX GBP.Day} }, \".\"] }, 0] },\n                            else: { $concat: [\"0\", { $arrayElemAt: [{ $split: [{ $toString: $$id{FOREX GBP.Day} }, \".\"] }, 0] }] }\n                        }}]  \n                        \n                        \n                        },\n                        $id{FOREX GBP.GBP Rate}:1\n                          }\n                      }\n                      \n                          ],\n                      as: \"ForecastPayExchangeRates\"\n                  }\n              },\n              {\n                  $set: { \n                      \"firstPayExchangeRates\" : { $arrayElemAt: [\"$ForecastPayExchangeRates\",0]} \n                  }\n              },\n              {\n                $unset: \"ForecastPayExchangeRates\"\n              },\n              {\n                  $set:{\n                      $id{View UK NFI Forecast.PayRateExchange}: { \n                          $cond: [ { $eq: [$$id{View UK NFI Forecast.PayRateSymbol}, \"£\"] } , 1, \"$firstPayExchangeRates._id{FOREX GBP.GBP Rate}\" ]\n                      }\n                  }\n              },\n              {\n                  $unset: [\"firstPayExchangeRates\"]\n              }\n              ,\n              {\n                  $set: {\n                      $id{View UK NFI Forecast.PayRateGBP}: {\n                          $cond: {\n                              if: { $gt: [$$id{View UK NFI Forecast.PayRateExchange}, 1] },\n                              then: { $divide: [$$id{View UK NFI Forecast.PayRate},$$id{View UK NFI Forecast.PayRateExchange}] },\n                              else: { $multiply: [$$id{View UK NFI Forecast.PayRate},$$id{View UK NFI Forecast.PayRateExchange}] }\n                          }\n                      }\n                  }\n              },\n              {\n                  $set:{\n                      $id{View UK NFI Forecast.PayRateGBP}: {\n                      $round: [{$toDouble:$$id{View UK NFI Forecast.PayRateGBP}},2]\n                      }\n                  }\n              }\n              /* END */\n              ,\n              \n              /* Working Days Lookup */\n              {\n                  $set: {\n                      wdLookup:{\n                      $concat: [\n                          \"UK\",\n                          {$toString: $$id{View UK NFI Forecast.Year} },\n                          {$toString: $$id{View UK NFI Forecast.Month} }\n                      ] \n                      }\n                  }\n              },\n              {\n                  $lookup:{\n                      from: \"dataInstances\",\n                      localField: \"wdLookup\",\n                      foreignField: \"compoundIndexValues._id{Metrics Working Days}.workingDaysLookup\",\n                      as: \"workingDays\"\n                  }\n              },\n              {\n                  $set: {\"firstWorkingDays\":{ $arrayElemAt: [\"$workingDays\",0]}}\n              },\n              {\n                  $set : { $id{View UK NFI Forecast.WorkingDays}: \"$firstWorkingDays._id{Metrics Working Days.Nos Days}\" }\n              },\n              {\n                  $unset: [\"workingDays\", \"firstWorkingDays\", \"wdLookup\"]\n              }\n              /* END */\n              ,\n\n              /* Calculate Net Revenue and final forecast GBP based on working days */\n              {\n                  $set: {\n                      $id{View UK NFI Forecast.NetRevenueGBP}: {\n                      $subtract:[ $$id{View UK NFI Forecast.ChargeRateGBP}, $$id{View UK NFI Forecast.PayRateGBP} ]\n                      }\n                  }\n              }\n              ,\n              {\n                  $set:{\n                      $id{View UK NFI Forecast.NetRevenueGBP}: {\n                      $round: [{$toDouble:$$id{View UK NFI Forecast.NetRevenueGBP}},2]\n                      }\n                  }\n              }\n              ,\n              {\n                  $set:{\n                          $id{View UK NFI Forecast.GBPLinePrice}: \n                          {\n                              $cond: {\n                                          if: {$eq: [ $$id{View UK NFI Forecast.Unit}, \"Per Day\"]},\n                                          then: \n                                          {\n                                              $multiply: [{$toDouble:$$id{View UK NFI Forecast.WorkingDays}}, {$toDouble:$$id{View UK NFI Forecast.NetRevenueGBP}}]\n                                          },\n                                          else: $$id{View UK NFI Forecast.GBPLinePrice}\n                                      }\n                          }\n                  }\n              }\n                  ,\n              {\n                  $set:{\n                      $id{View UK NFI Forecast.GBPLinePrice}: \n                          {\n                              $cond: {\n                                          if: {$eq: [ $$id{View UK NFI Forecast.Unit}, \"Per Hour\"]},\n                                          then: \n                                          {\n                                              $multiply: [7.5,{$toDouble:$$id{View UK NFI Forecast.WorkingDays}}, {$toDouble:$$id{View UK NFI Forecast.NetRevenueGBP}}]\n                                          },\n                                          else: $$id{View UK NFI Forecast.GBPLinePrice}\n                                      }\n                                  }\n                  }\n              }\n              ,\n              {\n                  $set:{\n                      $id{View UK NFI Forecast.GBPLinePrice}:\n                      {\n                          $round: [{$toDouble:$$id{View UK NFI Forecast.GBPLinePrice}},2]\n                      }\n                  }\n              }\n              /* END */\n              ,\n              {\n                  $set: { \n                      \"firstForecastDate\" : { $arrayElemAt: [\"$forecast_date\",0]} \n                  }\n              }\n              ,\n              {\n                  $set: {\n                      $id{View UK NFI Forecast.Forecast Cut Off}:\"$firstForecastDate.ForecastDate\"\n                  }\n              }\n              /* END */\n              ,\n              {\n                  $set:{\n                      $id{View UK NFI Forecast.NetRevenueGBP}: { $cond: { if: { $lte: [$$id{View UK NFI Forecast.InvoiceDate}, $$id{View UK NFI Forecast.Forecast Cut Off}] }, then: 0, else: $$id{View UK NFI Forecast.NetRevenueGBP} } }\n                  }\n                  \n                }\n                ,\n                {\n                  $set:{\n                      $id{View UK NFI Forecast.GBPLinePrice}: { $cond: { if: { $lte: [$$id{View UK NFI Forecast.InvoiceDate}, $$id{View UK NFI Forecast.Forecast Cut Off}] }, then: 0, else: $$id{View UK NFI Forecast.GBPLinePrice} } }\n                  }\n                  \n                }\n          ]\n      }\n  }\n  /* END Union with UK Placements Forecast */\n  ,\n  /* Consultant Look Up */\n  {\n   $set: {\n    consultantLookup: {\n     $concat: [\n      { $toString: $$id{View UK NFI Forecast.Placement} },\n      { $toString: $$id{View UK NFI Forecast.Candidate} }\n     ]\n    }\n   }\n  },\n  {\n   $lookup: {\n    from: \"dataInstances\",\n    localField: \"consultantLookup\",\n    foreignField: \"compoundIndexValues._id{TSP UK Placements Tracker}.placementCandidateLookup\",\n    as: \"consultants\"\n   }\n  },\n  {\n   $set: {\n    \"firstConsultant\": { $arrayElemAt: [\"$consultants\", 0] }\n   }\n  },\n  {\n   $set: {\n    $id{View UK NFI Forecast.Consultant}: \"$firstConsultant._id{TSP UK Placements Tracker.Consultant}\"\n   }\n  },\n  {\n   $unset: [\"consultants\", \"firstConsultant\", \"consultantLookup\"]\n  }\n  /* END */\n  ,\n  /* ChargeCode Look Up */\n  {\n   $lookup: {\n    from: \"dataInstances\",\n    localField: $id{View UK NFI Forecast.ChargeCode},\n    foreignField: $id{Metrics Charge Codes.ChargeCode},\n    as: \"types\"\n   }\n  },\n  {\n   $set: {\n    \"firstType\": { $arrayElemAt: [\"$types\", 0] }\n   }\n  },\n  {\n   $set: {\n    $id{View UK NFI Forecast.Type}: \"$firstType._id{Metrics Charge Codes.Type}\"\n   }\n  },\n  {\n   $unset: [\"types\", \"firstType\"]\n  }\n  /* END */\n  ,\n  /* Add Consultant Team and Country Lookup */\n  {\n    $lookup: {\n      from: $id{View Consultant Details},\n      localField: $id{View UK NFI Forecast.Consultant},\n      foreignField: $id{View Consultant Details.Consultant},\n      as: \"consultantDetails\"\n    }\n  },\n  {\n    $set: {\n      \"firstConsultantDetails\": {$arrayElemAt: [\"$consultantDetails\",0]}\n    }\n  },\n  {\n    $set: {\n      $id{View UK NFI Forecast.Team}: \"$firstConsultantDetails._id{View Consultant Details.Team}\",\n      $id{View UK NFI Forecast.Team Lead}: \"$firstConsultantDetails._id{View Consultant Details.Team Lead}\",\n      $id{View UK NFI Forecast.Country}: \"$firstConsultantDetails._id{View Consultant Details.Country}\"\n    }\n  }\n  \n]","typeClass":"com.xerini.xefr.model.XefrMongoViewSchema"},{"id":"fee7857a-ef11-455f-8622-c252e62c29d5","name":"View US NFI Forecast","description":"","attributes":[{"id":"b99221e8-66cc-487d-b511-ab517a22b74c","name":"Candidate","type":"STRING"},{"id":"4c7a6b5f-cc24-40dc-a636-1ec959481996","name":"CompanyName","type":"STRING"},{"id":"7c57cf94-57ef-4474-aff4-b36d31660fa9","name":"Placement","type":"STRING"},{"id":"efa4ac71-67d8-45be-8926-938ceb70670c","name":"InvoiceDate","type":"DATE"},{"id":"ccdd0914-d127-4621-be97-2b9c5f34620e","name":"Currency","type":"STRING"},{"id":"13a6cfb2-a43c-40e2-9c13-5bb589de6bca","name":"LinePrice","type":"NUMBER"},{"id":"8090e634-6045-4cc9-890e-5bbbf60d752d","name":"ChargeCode","type":"STRING"},{"id":"c9725ac8-8abf-49c3-a50c-3e39b58a8e5d","name":"Source","type":"STRING"},{"id":"6266bbfc-eee2-40a9-914d-bcd0626cf3ce","name":"Country","type":"STRING"},{"id":"9646b633-2625-47a1-98b2-2c836d2a86a4","name":"Year","type":"STRING"},{"id":"c78708c7-cec5-40bf-b1c2-28db30ed2a43","name":"Month","type":"STRING"},{"id":"cb7c3204-29ce-42ff-bd1e-b082cef289a4","name":"Day","type":"STRING"},{"id":"4703492c-7273-4f9f-892a-e3d1fefb2f81","name":"Quarter","type":"STRING"},{"id":"0e9589e1-0c58-4b5f-8801-a50a2f233e5e","name":"Multiplier","type":"NUMBER"},{"id":"8d18c82a-3486-48d6-9904-f04de004d504","name":"ExchangeRate","type":"NUMBER"},{"id":"e64778eb-6679-4863-a07b-401d6c728d3c","name":"Consultant","type":"STRING"},{"id":"28788c1c-4c42-4a5a-b851-f6125a901aef","name":"Type","type":"STRING"},{"id":"2b1f6cde-4490-450e-81d8-589c6076f875","name":"USDLinePrice","type":"NUMBER"},{"id":"40da2d1a-0235-47eb-97b3-168328287d59","name":"Forecast Cut Off","type":"DATE"},{"id":"c4b504ab-63d1-4787-9e8f-443b10f7bc8a","name":"ChargeRate","type":"NUMBER"},{"id":"49fb0b6f-2a84-4a82-8fa8-957d461caaa8","name":"ChargeRateSymbol","type":"STRING"},{"id":"8c039dc2-778a-4bc6-9292-73e6f0185e6b","name":"ChargeRateExchange","type":"NUMBER"},{"id":"c27158cf-0061-466c-9368-2ec544feabb6","name":"Placement Start","type":"DATE"},{"id":"80699966-4183-450a-9b97-f106207eb1a8","name":"Placement End","type":"DATE"},{"id":"ec9b88be-6ee6-4343-8935-d9d65cbb5dec","name":"PayRateSymbol","type":"STRING"},{"id":"a27f342f-ed2b-4180-8c8d-cc9a5b448bb2","name":"PayRate","type":"STRING"},{"id":"5c753647-9d0b-440c-a2f7-473706f8c164","name":"PayRateExchange","type":"NUMBER"},{"id":"ba9110a3-f364-4183-bfde-f047439029f8","name":"Unit","type":"STRING"},{"id":"47560622-f958-4c4c-a912-1b989ff3c661","name":"ChargeRateUSD","type":"NUMBER"},{"id":"9671eea9-6c39-4d98-a8ca-138b0da2b3c9","name":"PayRateUSD","type":"NUMBER"},{"id":"495202e9-8033-433c-9301-fcf4c3a45374","name":"NetRevenueUSD","type":"NUMBER"},{"id":"3de99f20-6248-4552-afbc-669768948d09","name":"WorkingDays","type":"NUMBER"},{"id":"c4d2211a-855f-48f1-ab3a-4fa6a76747c6","name":"Team","type":"STRING"},{"id":"20ce7dcd-8f99-438a-a78b-6186bef3c682","name":"Team Lead","type":"STRING"},{"id":"66372d04-d9d5-4b99-b6a4-94bd56d878a3","name":"GBPLinePrice","type":"NUMBER"}],"pipelineText":"[\n  {\n   $match: {\n    schemaId: $id{TSP US Invoice Tracker}\n   }\n  },\n  {\n   $project: {\n    id: 1,\n    schemaId: $id{View US NFI Forecast},\n    $id{View US NFI Forecast.Candidate}: $$id{TSP US Invoice Tracker.Candidate},\n    $id{View US NFI Forecast.CompanyName}: $$id{TSP US Invoice Tracker.CompanyName},\n    $id{View US NFI Forecast.Placement}: { $toString: $$id{TSP US Invoice Tracker.Placement} },\n    $id{View US NFI Forecast.InvoiceDate}: $$id{TSP US Invoice Tracker.InvoiceDate},\n    $id{View US NFI Forecast.Currency}: $$id{TSP US Invoice Tracker.Currency},\n    $id{View US NFI Forecast.LinePrice}: $$id{TSP US Invoice Tracker.LinePrice},\n    $id{View US NFI Forecast.ChargeCode}: $$id{TSP US Invoice Tracker.ChargeCode},\n    $id{View US NFI Forecast.Source}: $$id{TSP US Invoice Tracker.Source},\n    $id{View US NFI Forecast.Country}: $$id{TSP US Invoice Tracker.Country}\n   }\n  },\n  {\n   $unionWith: {\n    coll: \"dataInstances\",\n    pipeline: [\n     {\n      $match: {\n       schemaId: $id{TSP US Contractor Invoices Tracker}\n      }\n     },\n     {\n      $project: {\n       id: 1,\n       schemaId: $id{View US NFI Forecast},\n       $id{View US NFI Forecast.Candidate}: $$id{TSP US Contractor Invoices Tracker.Candidate},\n       $id{View US NFI Forecast.CompanyName}: $$id{TSP US Contractor Invoices Tracker.CompanyName},\n       $id{View US NFI Forecast.Placement}: { $toString: $$id{TSP US Contractor Invoices Tracker.Placement} },\n       $id{View US NFI Forecast.InvoiceDate}: $$id{TSP US Contractor Invoices Tracker.InvoiceDate},\n       $id{View US NFI Forecast.Currency}: $$id{TSP US Contractor Invoices Tracker.Currency},\n       $id{View US NFI Forecast.LinePrice}: $$id{TSP US Contractor Invoices Tracker.LinePrice},\n       $id{View US NFI Forecast.ChargeCode}: $$id{TSP US Contractor Invoices Tracker.ChargeCode},\n       $id{View US NFI Forecast.Source}: $$id{TSP US Contractor Invoices Tracker.Source},\n       $id{View US NFI Forecast.Country}: $$id{TSP US Contractor Invoices Tracker.Country}\n      }\n     }\n    ]\n   }\n  },\n  {\n   $unionWith: {\n    coll: \"dataInstances\",\n    pipeline: [\n     {\n      $match: {\n       schemaId: $id{Adjustments US NFI}\n      }\n     },\n     {\n      $project: {\n       id: 1,\n       schemaId: $id{View US NFI Forecast},\n       $id{View US NFI Forecast.Candidate}: $$id{Adjustments US NFI.Candidate},\n       $id{View US NFI Forecast.CompanyName}: $$id{Adjustments US NFI.CompanyName},\n       $id{View US NFI Forecast.Placement}: { $toString: $$id{Adjustments US NFI.Placement} },\n       $id{View US NFI Forecast.InvoiceDate}: $$id{Adjustments US NFI.InvoiceDate},\n       $id{View US NFI Forecast.Currency}: $$id{Adjustments US NFI.Currency},\n       $id{View US NFI Forecast.LinePrice}: $$id{Adjustments US NFI.LinePrice},\n       $id{View US NFI Forecast.ChargeCode}: $$id{Adjustments US NFI.ChargeCode},\n       $id{View US NFI Forecast.Source}: $$id{Adjustments US NFI.Source}\n      }\n     }\n    ]\n   }\n  },\n  {\n   $set: {\n    $id{View US NFI Forecast.Year}: { $dateToString: { format: \"%Y\", date: { $toDate: $$id{View US NFI Forecast.InvoiceDate} } } },\n    $id{View US NFI Forecast.Month}: { $concat: [{ $dateToString: { format: \"%m\", date: { $toDate: $$id{View US NFI Forecast.InvoiceDate} } } }, \"-\", { $arrayElemAt: [[\"\", \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"], { $month: { $toDate: $$id{View US NFI Forecast.InvoiceDate} } }] }] },\n    $id{View US NFI Forecast.Day}: { $dayOfMonth: { $toDate: $$id{View US NFI Forecast.InvoiceDate} } },\n    $id{View US NFI Forecast.Quarter}: { $concat: [\"Q\", { $arrayElemAt: [[\"\", \"1\", \"1\", \"1\", \"2\", \"2\", \"2\", \"3\", \"3\", \"3\", \"4\", \"4\", \"4\"], { $month: { $toDate: $$id{View US NFI Forecast.InvoiceDate} } }] }] },\n    $id{View US NFI Forecast.Multiplier}: { $cond: { if: { $eq: [$$id{View US NFI Forecast.Source}, \"TSP US Contractor Invoices\"] }, then: -1, else: 1 } }\n   }\n  },\n  {\n   $set: {\n    fxLookup: {\n     $concat: [\n      { $toString: $$id{View US NFI Forecast.Year} },\n      { $toString: $$id{View US NFI Forecast.Month} },\n      { $toString: $$id{View US NFI Forecast.Day} },\n      { $toString: $$id{View US NFI Forecast.Currency} }\n     ]\n    }\n   }\n  },\n  {\n   $lookup: {\n    from: \"dataInstances\",\n    localField: \"fxLookup\",\n    foreignField: \"compoundIndexValues._id{FOREX USD}.usdFXLookup\",\n    as: \"exchangeRates\"\n   }\n  },\n  {\n   $set: {\n    \"firstRate\": { $arrayElemAt: [\"$exchangeRates\", 0] }\n   }\n  },\n  {\n   $set: {\n    $id{View US NFI Forecast.ExchangeRate}: { $cond: [ { $eq: [$$id{View US NFI Forecast.Currency}, \"USD\"] } , 1, \"$firstRate._id{FOREX USD.USD Rate}\" ] }\n   }\n  },\n  {\n   $unset: [\"exchangeRates\", \"firstRate\", \"fxLookup\"]\n  }\n  ,\n  {\n   $set: {\n    $id{View US NFI Forecast.USDLinePrice}: {\n     $cond: {\n      if: { $gt: [$$id{View US NFI Forecast.ExchangeRate}, 1] },\n      then: { $multiply: [ $$id{View US NFI Forecast.Multiplier}, { $divide: [$$id{View US NFI Forecast.LinePrice}, $$id{View US NFI Forecast.ExchangeRate}] } ]},\n      else: { $multiply: [ $$id{View US NFI Forecast.Multiplier}, { $multiply: [$$id{View US NFI Forecast.LinePrice}, $$id{View US NFI Forecast.ExchangeRate}] } ]}\n     }\n    }\n   }\n  }\n  ,\n  /* Bring in the Forecast date */\n  {\n    $lookup: {\n      from: \"dataInstances\",\n      pipeline: [\n          {\n              $match: {\n              schemaId: $id{FOREX Forecast Date}\n              }\n          }\n          ,\n          {\n              $project: {\n              ForecastDate: $$id{FOREX Forecast Date.Forecast Date From}\n              }\n          }\n          ,\n          {\n              $sort: {\n              ForecastDate: -1\n              }\n          }\n          ,\n          {\n              $limit: 1\n          }  \n      ]\n      ,\n      as: \"forecast_date\"\n    }\n  }\n  ,\n  {\n      $set: { \n          \"firstForecastDate\" : { $arrayElemAt: [\"$forecast_date\",0]} \n      }\n  }\n  ,\n  {\n    $set: {\n      $id{View US NFI Forecast.Forecast Cut Off}:\"$firstForecastDate.ForecastDate\"\n    }\n  }\n  /* END */\n  ,\n  /* Union with US Placements Forecast */\n  {   \n      $unionWith: {\n          coll: \"dataInstances\",\n          pipeline: [\n              {\n                  $match: {\n                  schemaId: $id{TSP US Placements Forecast}\n                  }\n              }\n              ,\n              {\n                  $project: {\n                      id: 1,\n                      schemaId: $id{View US NFI Forecast},\n                      $id{View US NFI Forecast.Candidate}: $$id{TSP US Placements Forecast.Candidate},\n                      $id{View US NFI Forecast.ChargeCode}: \"Temp\",\n                      $id{View US NFI Forecast.CompanyName}: $$id{TSP US Placements Forecast.CompanyName},\n                      $id{View US NFI Forecast.Country}: \"US\",\n                      $id{View US NFI Forecast.Placement}: { $toString: $$id{TSP US Placements Forecast.Placement} },\n                      $id{View US NFI Forecast.InvoiceDate}: $$id{TSP US Placements Forecast.Forecast Date},\n                      $id{View US NFI Forecast.Currency}: \"n/a\",\n                      $id{View US NFI Forecast.LinePrice}: \"0\",\n                      $id{View US NFI Forecast.ChargeRate}: $$id{TSP US Placements Forecast.Charge Rate},\n                      $id{View US NFI Forecast.ChargeRateSymbol}: $$id{TSP US Placements Forecast.CC Desc},\n                      $id{View US NFI Forecast.Source}: \"US Placements Forecast\",      \n                      $id{View US NFI Forecast.Placement Start}: $$id{TSP US Placements Forecast.Placement Start},\n                      $id{View US NFI Forecast.Placement End}: $$id{TSP US Placements Forecast.Placement End},\n                      $id{View US NFI Forecast.PayRateSymbol}: $$id{TSP US Placements Forecast.PC Desc},\n                      $id{View US NFI Forecast.PayRate}: $$id{TSP US Placements Forecast.Pay Rate},\n                      $id{View US NFI Forecast.Unit}: $$id{TSP US Placements Forecast.Unit}\n                  }\n              }\n              ,\n              /* Common Calendar Columns */\n              {\n               $set: {\n                $id{View US NFI Forecast.Year}: { $dateToString: { format: \"%Y\", date: { $toDate: $$id{View US NFI Forecast.InvoiceDate} } } },\n                $id{View US NFI Forecast.Month}: { $concat: [{ $dateToString: { format: \"%m\", date: { $toDate: $$id{View US NFI Forecast.InvoiceDate} } } }, \"-\", { $arrayElemAt: [[\"\", \"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\", \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"], { $month: { $toDate: $$id{View US NFI Forecast.InvoiceDate} } }] }] },\n                $id{View US NFI Forecast.Day}: { $dayOfMonth: { $toDate: $$id{View US NFI Forecast.InvoiceDate} } },\n                $id{View US NFI Forecast.Quarter}: { $concat: [\"Q\", { $arrayElemAt: [[\"\", \"1\", \"1\", \"1\", \"2\", \"2\", \"2\", \"3\", \"3\", \"3\", \"4\", \"4\", \"4\"], { $month: { $toDate: $$id{View US NFI Forecast.InvoiceDate} } }] }] },\n                $id{View US NFI Forecast.Multiplier}: { $cond: { if: { $eq: [$$id{View US NFI Forecast.Source}, \"TSP US Contractor Invoices\"] }, then: -1, else: 1 } }\n               }\n              }\n              ,\n              /* Bring in Forecast Cut Off Date */\n              {\n                $lookup: {\n                  from: \"dataInstances\",\n                  pipeline: [\n                      {\n                        $match: {\n                          schemaId: $id{FOREX Forecast Date}\n                        }\n                      }\n                      ,\n                      {\n                        $project: {\n                          ForecastDate: $$id{FOREX Forecast Date.Forecast Date From}\n                        }\n                      }\n                      ,\n                      {\n                        $sort: {\n                          ForecastDate: -1\n                        }\n                      }\n                      ,\n                      {\n                        $limit: 1\n                      }  \n                  ]\n                  ,\n                  as: \"forecast_date\"\n                }\n              }\n              ,\n              {\n                  $set: { \n                      \"firstForecastDate\" : { $arrayElemAt: [\"$forecast_date\",0]} \n                  }\n              }\n              ,\n              {\n                $set: {\n                  $id{View US NFI Forecast.Forecast Cut Off}:\"$firstForecastDate.ForecastDate\"\n                }\n              }\n              ,\n              /* END */\n              /* Charge Rate FX lookup */\n              {\n                  $lookup: {\n                      from: \"dataInstances\",\n                      localField: $id{View US NFI Forecast.ChargeRateSymbol},\n                      foreignField: $id{FOREX USD.Symbol},\n                      pipeline: [\n                        {\n                          $sort: {\n                            $id{FOREX GBP.Year}: -1, $id{FOREX GBP.Month}: -1, $id{FOREX GBP.Day}: -1\n                          }\n                        },\n                        {\n                          $limit: 1\n                        },\n\n                                  {\n                                      $project:{\n\n                                      yyyymmdd: { \n                                        \n                                      $concat: [ $$id{FOREX USD.Year}, {$substr: [$$id{FOREX USD.Month}, 0, 2 ]}, {$cond: {\n                                        if: { $gte: [{ $strLenCP: { $arrayElemAt: [{ $split: [{ $toString: $$id{FOREX USD.Day} }, \".\"] }, 0] }}, 2] },\n                                        then: { $arrayElemAt: [{ $split: [{ $toString: $$id{FOREX USD.Day} }, \".\"] }, 0] },\n                                        else: { $concat: [\"0\", { $arrayElemAt: [{ $split: [{ $toString: $$id{FOREX USD.Day} }, \".\"] }, 0] }] }\n                                    }}]  \n                                    \n                                    \n                                    },\n                                    $id{FOREX USD.USD Rate}:1\n                                      }\n                                  }\n                                  /* END */\n                                  \n                          ],\n                      as: \"ForecastChargeExchangeRates\"\n                  }\n              }\n              ,\n              {\n                  $set: { \n                      \"firstChargeExchangeRates\" : { $arrayElemAt: [\"$ForecastChargeExchangeRates\",0]} \n                  }\n              },\n              {\n                $unset: \"ForecastChargeExchangeRates\"\n              }\n              ,\n              {\n                  $set:{\n                          $id{View US NFI Forecast.ChargeRateExchange}: { \n                          $cond: [ { $eq: [$$id{View US NFI Forecast.ChargeRateSymbol}, \"USD\"] } , 1, \"$firstChargeExchangeRates._id{FOREX USD.USD Rate}\" ]\n                      }\n                  }\n              }\n              ,\n              {\n                  $unset: [ \"firstChargeExchangeRates\"]\n              }\n              ,\n              {\n                  $set: {\n                      $id{View US NFI Forecast.ChargeRateUSD}: {\n                          $cond: {\n                              if: { $gt: [$$id{View US NFI Forecast.ChargeRateExchange}, 1] },\n                              then: { $divide: [$$id{View US NFI Forecast.ChargeRate},$$id{View US NFI Forecast.ChargeRateExchange}] },\n                              else: { $multiply: [$$id{View US NFI Forecast.ChargeRate},$$id{View US NFI Forecast.ChargeRateExchange}]}\n                          }\n                      }\n                  }\n              }\n              ,\n              {\n                  $set:{\n                      $id{View US NFI Forecast.ChargeRateUSD}: {\n                          $round: [{$toDouble:$$id{View US NFI Forecast.ChargeRateUSD}},2]\n                          \n                      }\n                  }\n              }\n              /* END */\n              ,\n              /* Pay Rate FX Lookup */\n              {\n                  $lookup: {\n                      from: \"dataInstances\",\n                      localField: $id{View US NFI Forecast.PayRateSymbol},\n                      foreignField: $id{FOREX USD.Symbol},\n                      pipeline: [\n\n                        {\n                          $project:{\n\n                          yyyymmdd: { \n                            \n                          $concat: [ $$id{FOREX USD.Year}, {$substr: [$$id{FOREX USD.Month}, 0, 2 ]}, {$cond: {\n                            if: { $gte: [{ $strLenCP: { $arrayElemAt: [{ $split: [{ $toString: $$id{FOREX USD.Day} }, \".\"] }, 0] }}, 2] },\n                            then: { $arrayElemAt: [{ $split: [{ $toString: $$id{FOREX USD.Day} }, \".\"] }, 0] },\n                            else: { $concat: [\"0\", { $arrayElemAt: [{ $split: [{ $toString: $$id{FOREX USD.Day} }, \".\"] }, 0] }] }\n                        }}]  \n                        \n                        \n                        },\n                        $id{FOREX USD.USD Rate}:1\n                          }\n                      }\n                      /* END */\n                      ,\n                      {\n                          $sort:\n                          {\n                              \"yyyymmdd\": -1\n                          }\n                      },\n                      {\n                          $limit:1\n                      }\n                          ],\n                      as: \"ForecastPayExchangeRates\"\n                  }\n              },\n              {\n                  $set: { \n                      \"firstPayExchangeRates\" : { $arrayElemAt: [\"$ForecastPayExchangeRates\",0]} \n                  }\n              },\n              {\n                $unset: \"ForecastPayExchangeRates\"\n              },\n              {\n                  $set:{\n                      $id{View US NFI Forecast.PayRateExchange}: { \n                          $cond: [ { $eq: [$$id{View US NFI Forecast.PayRateSymbol}, \"USD\"] } , 1, \"$firstPayExchangeRates._id{FOREX USD.USD Rate}\" ]\n                      }\n                  }\n              },\n              {\n                  $unset: [\"firstPayExchangeRates\"]\n              }\n              ,\n              {\n                  $set: {\n                      $id{View US NFI Forecast.PayRateUSD}: {\n                          $cond: {\n                              if: { $gt: [$$id{View US NFI Forecast.PayRateExchange}, 1] },\n                              then: { $divide: [$$id{View US NFI Forecast.PayRate},$$id{View US NFI Forecast.PayRateExchange}] },\n                              else: { $multiply: [$$id{View US NFI Forecast.PayRate},$$id{View US NFI Forecast.PayRateExchange}] }\n                          }\n                      }\n                  }\n              },\n              {\n                  $set:{\n                      $id{View US NFI Forecast.PayRateUSD}: {\n                      $round: [{$toDouble:$$id{View US NFI Forecast.PayRateUSD}},2]\n                      }\n                  }\n              }\n              /* END */\n              ,\n              \n              /* Working Days Lookup */\n              {\n                  $set: {\n                      wdLookup:{\n                      $concat: [\n                          \"US\",\n                          {$toString: $$id{View US NFI Forecast.Year} },\n                          {$toString: $$id{View US NFI Forecast.Month} }\n                      ] \n                      }\n                  }\n              },\n              {\n                  $lookup:{\n                      from: \"dataInstances\",\n                      localField: \"wdLookup\",\n                      foreignField: \"compoundIndexValues._id{Metrics Working Days}.workingDaysLookup\",\n                      as: \"workingDays\"\n                  }\n              },\n              {\n                  $set: {\"firstWorkingDays\":{ $arrayElemAt: [\"$workingDays\",0]}}\n              },\n              {\n                  $set : { $id{View US NFI Forecast.WorkingDays}: \"$firstWorkingDays._id{Metrics Working Days.Nos Days}\" }\n              },\n              {\n                  $unset: [\"workingDays\", \"firstWorkingDays\", \"wdLookup\"]\n              }\n              /* END */\n              ,\n\n              /* Calculate Net Revenue and final forecast USD based on working days */\n              {\n                  $set: {\n                      $id{View US NFI Forecast.NetRevenueUSD}: {\n                      $subtract:[ $$id{View US NFI Forecast.ChargeRateUSD}, $$id{View US NFI Forecast.PayRateUSD} ]\n                      }\n                  }\n              }\n              ,\n              {\n                  $set:{\n                      $id{View US NFI Forecast.NetRevenueUSD}: {\n                      $round: [{$toDouble:$$id{View US NFI Forecast.NetRevenueUSD}},2]\n                      }\n                  }\n              }\n              ,\n              {\n                  $set:{\n                          $id{View US NFI Forecast.USDLinePrice}: \n                          {\n                              $cond: {\n                                          if: {$eq: [ $$id{View US NFI Forecast.Unit}, \"Per Day\"]},\n                                          then: \n                                          {\n                                              $multiply: [{$toDouble:$$id{View US NFI Forecast.WorkingDays}}, {$toDouble:$$id{View US NFI Forecast.NetRevenueUSD}}]\n                                          },\n                                          else: $$id{View US NFI Forecast.USDLinePrice}\n                                      }\n                          }\n                  }\n              }\n                  ,\n              {\n                  $set:{\n                      $id{View US NFI Forecast.USDLinePrice}: \n                          {\n                              $cond: {\n                                          if: {$eq: [ $$id{View US NFI Forecast.Unit}, \"Per Hour\"]},\n                                          then: \n                                          {\n                                              $multiply: [7.5,{$toDouble:$$id{View US NFI Forecast.WorkingDays}}, {$toDouble:$$id{View US NFI Forecast.NetRevenueUSD}}]\n                                          },\n                                          else: $$id{View US NFI Forecast.USDLinePrice}\n                                      }\n                                  }\n                  }\n              }\n              ,\n              {\n                  $set:{\n                      $id{View US NFI Forecast.USDLinePrice}:\n                      {\n                          $round: [{$toDouble:$$id{View US NFI Forecast.USDLinePrice}},2]\n                      }\n                  }\n              }\n              /* END */\n              ,\n              {\n                  $set: { \n                      \"firstForecastDate\" : { $arrayElemAt: [\"$forecast_date\",0]} \n                  }\n              }\n              ,\n              {\n                  $set: {\n                      $id{View US NFI Forecast.Forecast Cut Off}:\"$firstForecastDate.ForecastDate\"\n                  }\n              }\n              /* END */\n              ,\n              {\n                  $set:{\n                      $id{View US NFI Forecast.NetRevenueUSD}: { $cond: { if: { $lte: [$$id{View US NFI Forecast.InvoiceDate}, $$id{View US NFI Forecast.Forecast Cut Off}] }, then: 0, else: $$id{View US NFI Forecast.NetRevenueUSD} } }\n                  }\n                  \n                }\n                ,\n                {\n                  $set:{\n                      $id{View US NFI Forecast.USDLinePrice}: { $cond: { if: { $lte: [$$id{View US NFI Forecast.InvoiceDate}, $$id{View US NFI Forecast.Forecast Cut Off}] }, then: 0, else: $$id{View US NFI Forecast.USDLinePrice} } }\n                  }\n                  \n                }\n          ]\n      }\n  }\n  /* END Union with US Placements Forecast */\n  ,\n  /* Consultant Look Up */\n  {\n   $set: {\n    consultantLookup: {\n     $concat: [\n      { $toString: $$id{View US NFI Forecast.Placement} },\n      { $toString: $$id{View US NFI Forecast.Candidate} }\n     ]\n    }\n   }\n  },\n  {\n   $lookup: {\n    from: \"dataInstances\",\n    localField: \"consultantLookup\",\n    foreignField: \"compoundIndexValues._id{TSP US Placements Tracker}.placementCandidateLookup\",\n    as: \"consultants\"\n   }\n  },\n  {\n   $set: {\n    \"firstConsultant\": { $arrayElemAt: [\"$consultants\", 0] }\n   }\n  },\n  {\n   $set: {\n    $id{View US NFI Forecast.Consultant}: \"$firstConsultant._id{TSP US Placements Tracker.Consultant}\"\n   }\n  },\n  {\n   $unset: [\"consultants\", \"firstConsultant\", \"consultantLookup\"]\n  }\n  /* END */\n  ,\n  /* ChargeCode Look Up */\n  {\n   $lookup: {\n    from: \"dataInstances\",\n    localField: $id{View US NFI Forecast.ChargeCode},\n    foreignField: $id{Metrics Charge Codes.ChargeCode},\n    as: \"types\"\n   }\n  },\n  {\n   $set: {\n    \"firstType\": { $arrayElemAt: [\"$types\", 0] }\n   }\n  },\n  {\n   $set: {\n    $id{View US NFI Forecast.Type}: \"$firstType._id{Metrics Charge Codes.Type}\"\n   }\n  },\n  {\n   $unset: [\"types\", \"firstType\"]\n  }\n  /* END */\n  ,\n  /* Add Consultant Team and Country Lookup */\n  {\n    $lookup: {\n      from: $id{View Consultant Details},\n      localField: $id{View US NFI Forecast.Consultant},\n      foreignField: $id{View Consultant Details.Consultant},\n      as: \"consultantDetails\"\n    }\n  },\n  {\n    $set: {\n      \"firstConsultantDetails\": {$arrayElemAt: [\"$consultantDetails\",0]}\n    }\n  },\n  {\n    $set: {\n      $id{View US NFI Forecast.Team}: \"$firstConsultantDetails._id{View Consultant Details.Team}\",\n      $id{View US NFI Forecast.Team Lead}: \"$firstConsultantDetails._id{View Consultant Details.Team Lead}\",\n      $id{View US NFI Forecast.Country}: \"$firstConsultantDetails._id{View Consultant Details.Country}\"\n    }\n  }\n  \n]","typeClass":"com.xerini.xefr.model.XefrMongoViewSchema"}]